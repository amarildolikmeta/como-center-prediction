{"version":"NotebookV1","origId":3170457594604173,"name":"4- Decision Tree Classifier","language":"python","commands":[{"version":"CommandV1","origId":2998738568508548,"guid":"34891b7e-479e-4acf-b19d-7fa744d5e31c","subtype":"command","commandType":"auto","position":3.5,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"135ad1a8-0a9c-4ebc-bf30-701f8e344785"},{"version":"CommandV1","origId":2998738568508549,"guid":"25302e9f-b79f-4a84-8d07-d2f030a3717a","subtype":"command","commandType":"auto","position":1.75,"command":"features.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">3</span><span class=\"ansired\">]: </span>289\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1500293596382,"submitTime":1500293593428,"finishTime":1500293603643,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ec50efa5-8ab1-4bec-ae90-9c247e9fb673"},{"version":"CommandV1","origId":3170457594604175,"guid":"8a61f7bf-91fc-455b-85b1-4929dce846f5","subtype":"command","commandType":"auto","position":1.0,"command":"features=sqlContext.sql(\"Select month,doy,dow,int(temperature),desc from labeleddata\")\nlabels=sqlContext.sql(\"Select label from labeleddata\")\nlabels2=sqlContext.sql(\"Select label from labeleddataquantile\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1500293593711,"submitTime":1500293593422,"finishTime":1500293596260,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c6020caf-52d0-4330-8810-651818ef4226"},{"version":"CommandV1","origId":3170457594604176,"guid":"908bbd8a-d55a-4776-90d0-98ed6fdd2d1a","subtype":"command","commandType":"auto","position":2.0,"command":"features.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+---+---+-----------+----+\n|month|doy|dow|temperature|desc|\n+-----+---+---+-----------+----+\n|   11|330|  4|         11|   7|\n|   11|325|  6|          8|  13|\n|   11|326|  0|          9|   7|\n|   11|320|  1|          7|  17|\n|   11|316|  4|          8|  14|\n|   11|307|  2|         14|  14|\n|   11|319|  0|          8|  18|\n|   11|328|  2|         12|   8|\n|   11|332|  6|         11|  20|\n|   11|306|  1|         13|  18|\n|   11|324|  5|          8|   8|\n|   11|318|  6|         10|  18|\n|   11|333|  0|         10|  14|\n|   11|309|  4|         12|  18|\n|   11|323|  4|          8|  14|\n|   11|322|  3|          7|  14|\n|   11|334|  1|          5|  18|\n|   11|331|  5|         13|  18|\n|   11|321|  2|          8|  14|\n|   11|327|  1|         11|   7|\n+-----+---+---+-----------+----+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1500293603649,"submitTime":1500293593432,"finishTime":1500293604376,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"186df13a-7ac1-485d-b1f3-e06fec7e9aec"},{"version":"CommandV1","origId":3170457594604177,"guid":"b91a8be5-891f-40a4-9cf6-596b563c34a8","subtype":"command","commandType":"auto","position":3.0,"command":"featuresRDD=features.rdd.map(lambda x:(x[0],x[2],x[3],x[4]))\nlabelsRDD=labels.rdd.map(lambda x:BoolToInt(x[0]))\nlabelsRDD2=labels2.rdd.map(lambda x:BoolToInt(x[0]))\nlabelsRDD.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">6</span><span class=\"ansired\">]: </span>[0, 1, 0, 0, 0]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1500293604427,"submitTime":1500293593439,"finishTime":1500293607849,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9ce9a0b8-8b1a-48fb-94f7-0cb173d94a63"},{"version":"CommandV1","origId":3170457594604178,"guid":"9685efe1-b4fb-4823-8a29-7f39a8f7cd97","subtype":"command","commandType":"auto","position":4.0,"command":"featuresArray=np.array(featuresRDD.collect())\nlabelsArray=np.array(labelsRDD.collect())\nlabelsArray2=np.array(labelsRDD2.collect())\nlabelsArray[0:5]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">7</span><span class=\"ansired\">]: </span>array([0, 1, 0, 0, 0])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1500293607854,"submitTime":1500293593448,"finishTime":1500293619734,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0932528f-86e7-4e8f-a7d4-c6cd3b3d4cf9"},{"version":"CommandV1","origId":3170457594604179,"guid":"12bbe45d-d3ed-4437-8409-5a76227072d9","subtype":"command","commandType":"auto","position":2.5,"command":"def BoolToInt(x):\n  if x:\n    return 1\n  else:\n    return 0","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1500293604383,"submitTime":1500293593435,"finishTime":1500293604423,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"631884d7-83a7-49ee-99c1-7dc31ec972ed"},{"version":"CommandV1","origId":3170457594604180,"guid":"7bcd09b2-ad15-4807-bc40-9755025619c3","subtype":"command","commandType":"auto","position":5.0,"command":"msk = np.random.rand(len(featuresArray)) < 0.8\n\ntrain = featuresArray[msk]\n\ntest = featuresArray[~msk]\ntrainLabel = labelsArray[msk]\ntrainLabel2 = labelsArray2[msk]\ntestLabel = labelsArray[~msk]\ntestLabel2 = labelsArray2[~msk]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1500293619738,"submitTime":1500293593452,"finishTime":1500293619777,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1381a4fd-0acc-44a1-983b-3c588df88628"},{"version":"CommandV1","origId":3170457594604181,"guid":"f66af592-02a8-4fb8-ad74-df8b1db23302","subtype":"command","commandType":"auto","position":1.5,"command":"import numpy as np","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1500293596304,"submitTime":1500293593424,"finishTime":1500293596377,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"87c5fd4c-dd6a-4f0d-9e43-b0a3685a38ff"},{"version":"CommandV1","origId":3170457594604182,"guid":"aacd5c25-c33c-40f0-8e88-86ef771dbe7c","subtype":"command","commandType":"auto","position":6.0,"command":"from sklearn.tree import DecisionTreeClassifier","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1500293619781,"submitTime":1500293593455,"finishTime":1500293620022,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"742e7b99-d7ed-40a3-ba99-454f5d127726"},{"version":"CommandV1","origId":4437567718367220,"guid":"cb1573a3-3f32-4ebf-bd53-52ef3371180e","subtype":"command","commandType":"auto","position":7.0,"command":"tree=DecisionTreeClassifier(max_depth=5)\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1500293620025,"submitTime":1500293593458,"finishTime":1500293620049,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"06039fa4-3483-4c07-a0ae-b3eef0009e2c"},{"version":"CommandV1","origId":4437567718367221,"guid":"f50a2d1d-d9a6-4395-96cd-f7ef81014dda","subtype":"command","commandType":"auto","position":8.0,"command":"tree.fit(train, trainLabel)\nscore = tree.score(test,testLabel)\nscore","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">11</span><span class=\"ansired\">]: </span>0.82222222222222219\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1500293620052,"submitTime":1500293593462,"finishTime":1500293620093,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9131176e-0ef0-47cf-957c-72ce8303fb5f"},{"version":"CommandV1","origId":4437567718367222,"guid":"c8e6b1c0-bf03-440d-b7c3-01a67974fb15","subtype":"command","commandType":"auto","position":9.0,"command":"tree.fit(train, trainLabel2)\nscore = tree.score(test,testLabel2)\nscore","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">12</span><span class=\"ansired\">]: </span>0.80000000000000004\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1500293620096,"submitTime":1500293593465,"finishTime":1500293620140,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"17399d86-65e3-49c7-ba2c-25d44c9fca83"}],"dashboards":[],"guid":"a5c279f3-7505-4967-94cb-c2cd44300d72","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}