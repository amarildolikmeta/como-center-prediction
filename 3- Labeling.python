{"version":"NotebookV1","origId":3170457594604151,"name":"3- Labeling","language":"python","commands":[{"version":"CommandV1","origId":2751569960862876,"guid":"2c7b2c36-3078-4f77-bab5-46c39e5e4d9f","subtype":"command","commandType":"auto","position":14.5,"command":"quantiles=sqlContext.sql(\"Select * from quantiles\").rdd.map(lambda x:(int(x[0]),float(x[1])))\nquantiles.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">15</span><span class=\"ansired\">]: </span>\n[(2, 5273.5),\n (4, 13997.25),\n (9, 15345.0),\n (10, 13545.5),\n (12, 16966.0),\n (8, 9888.5),\n (11, 8916.5),\n (1, 10550.0),\n (3, 5846.0),\n (5, 6792.0),\n (7, 10448.0)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;quanties&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-1-dd5b72af2903&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> quantiles<span class=\"ansiyellow\">=</span>sqlContext<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Select * from quantiles&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>rdd<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\">(</span>int<span class=\"ansiyellow\">(</span>x<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>float<span class=\"ansiyellow\">(</span>x<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>quanties<span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;quanties&apos; is not defined</div>","workflows":[],"startTime":1500291865245,"submitTime":1500291812807,"finishTime":1500291869066,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"213dc3b7-1dd4-458a-b0a3-4ac12350a3c4"},{"version":"CommandV1","origId":2751569960862877,"guid":"1a941773-4a1d-4d1e-81b2-2191a6c50c93","subtype":"command","commandType":"auto","position":15.5,"command":"df1 = sqlContext.createDataFrame(totalRDD2, schema=['doy','month', 'dow', 'temperature','desc','count'])\ndf2 = sqlContext.createDataFrame(quantiles, schema=['month','threshold'])\nrdd_join = df1.join(df2, on=['month'])\ntotalRDD2 = rdd_join.rdd\ntotalRDD2.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">17</span><span class=\"ansired\">]: </span>\n[Row(month=7, doy=212, dow=5, temperature=29.731999588012695, desc=18, count=10908, threshold=10448.0),\n Row(month=7, doy=209, dow=2, temperature=27.86400032043457, desc=9, count=8791, threshold=10448.0),\n Row(month=7, doy=208, dow=1, temperature=29.76799964904785, desc=18, count=7680, threshold=10448.0),\n Row(month=7, doy=207, dow=0, temperature=30.579999923706055, desc=19, count=3597, threshold=10448.0),\n Row(month=7, doy=210, dow=3, temperature=27.252000045776366, desc=19, count=10463, threshold=10448.0)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291872696,"submitTime":1500291812827,"finishTime":1500291880637,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"36378744-67f4-4e48-94f0-41c614b5f272"},{"version":"CommandV1","origId":2751569960862879,"guid":"1dfcac07-44cb-405c-8747-381306df8116","subtype":"command","commandType":"auto","position":22.0,"command":"labeledDF2.write.saveAsTable('labeleddataQuantile')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291902853,"submitTime":1500291812897,"finishTime":1500291912737,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9a3ffb82-85be-479c-92c5-d15bd9c257a9"},{"version":"CommandV1","origId":2751569960862880,"guid":"43368759-b336-4dc6-8c67-7990a0cf1399","subtype":"command","commandType":"auto","position":21.5,"command":"%sql DROP TABLE labeleddataquantile","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291898533,"submitTime":1500291812891,"finishTime":1500291902851,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4c464a29-87e4-43e2-bbef-6b7588333fc2"},{"version":"CommandV1","origId":2751569960862881,"guid":"0a5ffc37-e556-435c-80e8-d383c4c1a13b","subtype":"command","commandType":"auto","position":23.0,"command":"totalRDD2.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">24</span><span class=\"ansired\">]: </span>289\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291912740,"submitTime":1500291812903,"finishTime":1500291914048,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0e47eee3-bd03-4938-ad03-7e6b2965538c"},{"version":"CommandV1","origId":2998738568508547,"guid":"cf077337-48c4-4422-876a-3aa9f7880998","subtype":"command","commandType":"auto","position":21.0,"command":"labeledDF.write.saveAsTable('labeleddata')\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;Table &#96;labeleddataQuantile&#96; already exists.;&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-47-9a3cd3f4433e&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> labeledDF<span class=\"ansiyellow\">.</span>write<span class=\"ansiyellow\">.</span>saveAsTable<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;labeleddata&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>labeledDF2<span class=\"ansiyellow\">.</span>write<span class=\"ansiyellow\">.</span>saveAsTable<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;labeleddataQuantile&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/readwriter.pyc</span> in <span class=\"ansicyan\">saveAsTable</span><span class=\"ansiblue\">(self, name, format, mode, partitionBy, **options)</span>\n<span class=\"ansigreen\">    586</span>         <span class=\"ansigreen\">if</span> format <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    587</span>             self<span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>format<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 588</span><span class=\"ansiyellow\">         </span>self<span class=\"ansiyellow\">.</span>_jwrite<span class=\"ansiyellow\">.</span>saveAsTable<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    589</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    590</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.4</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&apos;Table &#96;labeleddataQuantile&#96; already exists.;&apos;</div>","workflows":[],"startTime":1500291889161,"submitTime":1500291812884,"finishTime":1500291898530,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3db1a00f-8125-47be-b1af-abc99d0bfdb1"},{"version":"CommandV1","origId":3170457594604153,"guid":"695cb01c-93bd-4848-9ef9-4f89791af538","subtype":"command","commandType":"auto","position":1.0,"command":"data=sqlContext.sql(\"Select * from joineddata where hour>=7 and hour<17  \")\ndata.show()","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-----+---+----+-----------+-------------------+----+----+\n|day|month|dow|hour|description|        temperature|  fw|  bw|\n+---+-----+---+----+-----------+-------------------+----+----+\n| 10|    1|  1|   9|         18|-2.0299999713897705| 840| 808|\n| 11|    1|  2|  11|         18|-0.7699999809265137|1186|1254|\n| 34|    2|  4|  13|          5|  6.369999885559082| 773| 752|\n| 44|    2|  0|  16|         14|   7.78000020980835| 875|1167|\n| 80|    3|  1|   9|         14| 13.380000114440918| 704| 755|\n| 86|    3|  0|   7|         18|                9.0| 337| 146|\n| 87|    3|  1|  16|         20|  18.15999984741211|1086|1240|\n|228|    8|  0|  13|         19|   28.1299991607666|1792|1680|\n|238|    8|  3|   7|         18|  18.40999984741211| 189| 187|\n|247|    9|  5|  15|         19| 30.110000610351562|3888|3645|\n|257|    9|  1|  10|         20| 22.389999389648438|2536|2214|\n|280|   10|  3|  10|         18| 12.390000343322754|1730|1464|\n|311|   11|  6|  10|          7|   9.59000015258789| 859| 842|\n|314|   11|  2|  13|         20|               8.25| 918|1000|\n|331|   11|  5|  16|         19| 13.970000267028809|5803|5124|\n|332|   11|  6|  15|         20| 12.569999694824219|6689|6092|\n|345|   12|  5|   9|         13|-1.6100000143051147|1395|1242|\n|352|   12|  5|  12|         13|  2.569999933242798|3627|3848|\n|  2|    1|  0|  10|         14|-1.0499999523162842|1592|1380|\n| 22|    1|  6|  10|         20| -2.049999952316284| 765| 992|\n+---+-----+---+----+-----------+-------------------+----+----+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291812956,"submitTime":1500291812649,"finishTime":1500291814467,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ec7af7a8-39ab-4a70-9977-0623a2a0e259"},{"version":"CommandV1","origId":3170457594604154,"guid":"47216466-afa1-4393-addf-93437655a13a","subtype":"command","commandType":"auto","position":2.0,"command":"dataRDD=data.rdd.map(lambda x:(int(x[0]),int(x[1]),int(x[2]),int(x[3]),int(x[4]),float(x[5]),int(x[6])))\ndataRDD.take(5)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">2</span><span class=\"ansired\">]: </span>\n[(10, 1, 1, 9, 18, -2.0299999713897705, 840),\n (11, 1, 2, 11, 18, -0.7699999809265137, 1186),\n (34, 2, 4, 13, 5, 6.369999885559082, 773),\n (44, 2, 0, 16, 14, 7.78000020980835, 875),\n (80, 3, 1, 9, 14, 13.380000114440918, 704)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291814470,"submitTime":1500291812651,"finishTime":1500291818088,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"487bee61-2b4f-4bee-8c6b-8942904eba91"},{"version":"CommandV1","origId":3170457594604155,"guid":"68d95c57-27ec-4404-ae95-c2a219b5fe3c","subtype":"command","commandType":"auto","position":3.0,"command":"descCalc=dataRDD.map(lambda x:((x[0],x[4]),1)).reduceByKey(lambda x,y:x+y)\ndescCalc.take(5)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">3</span><span class=\"ansired\">]: </span>[((299, 7), 6), ((42, 8), 1), ((95, 19), 1), ((247, 19), 8), ((261, 9), 5)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291818091,"submitTime":1500291812664,"finishTime":1500291824121,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cb3eb31c-f9e7-4d3c-8c67-5e9c7b53ea7b"},{"version":"CommandV1","origId":3170457594604156,"guid":"79d08c3d-7b22-4c50-9715-bde4a2c77272","subtype":"command","commandType":"auto","position":4.0,"command":"def getBestDesc(list):\n  list = sorted(list, key=lambda tup: tup[1],reverse=True)    \n  return list[0][0]","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291824124,"submitTime":1500291812677,"finishTime":1500291824162,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"90a4a425-50e4-4b6f-ab5f-e3c9274325f4"},{"version":"CommandV1","origId":3170457594604157,"guid":"324edf87-8d05-4bb4-a914-9ca8b58991fc","subtype":"command","commandType":"auto","position":5.0,"command":"descCalc=descCalc.map(lambda x:(x[0][0],[(x[0][1],x[1])])).reduceByKey(lambda x,y:x+y).map(lambda x:(x[0],getBestDesc(x[1])))\ndescCalc.take(10)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">5</span><span class=\"ansired\">]: </span>\n[(128, 5),\n (256, 19),\n (136, 20),\n (144, 20),\n (88, 20),\n (352, 13),\n (280, 18),\n (312, 19),\n (32, 14),\n (112, 20)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291824165,"submitTime":1500291812690,"finishTime":1500291824386,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cf42af75-3d18-42a3-bd43-4bb89e54b3f3"},{"version":"CommandV1","origId":3170457594604158,"guid":"cc428f25-1b86-401e-9136-091313e04099","subtype":"command","commandType":"auto","position":6.0,"command":"data=sqlContext.sql(\"Select day ,month,dow ,first(description) as desc, avg(temperature) as temperature ,sum(fw) as count from joineddata where hour>=12 and hour<17 group by day,month,dow\")\ndata.show()","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-----+---+----+------------------+-----+\n|day|month|dow|desc|       temperature|count|\n+---+-----+---+----+------------------+-----+\n| 42|    2|  5|  14|5.4679999351501465| 6875|\n| 45|    2|  1|  20| 8.404000091552735| 4916|\n|271|    9|  1|  19|22.795000076293945|10806|\n| 50|    2|  6|  20| 8.943999671936036| 7447|\n|351|   12|  4|  14|4.2779998779296875| 9711|\n| 51|    2|  0|  18|  7.44399995803833| 4251|\n| 79|    3|  0|  14|16.243999671936034| 4624|\n|138|    5|  3|  18|23.604000091552734| 6169|\n|216|    8|  2|  19|28.219999694824217| 8630|\n| 83|    3|  4|   8|13.046000289916993| 4431|\n|255|    9|  6|  19|28.536000061035157|17590|\n|127|    5|  6|   9|14.395999908447266| 7970|\n|106|    4|  6|  19| 21.75199966430664|13362|\n|360|   12|  6|  19| 9.776000213623046| 4580|\n|275|   10|  5|   9|20.536000442504882|19219|\n| 21|    1|  5|  20| 5.627500057220459| 6381|\n|242|    8|  0|  19|29.020000076293947| 5899|\n| 97|    4|  4|  20|15.955999946594238| 9346|\n|260|    9|  4|   5|20.989999771118164|11879|\n| 85|    3|  6|  18|12.270000076293945| 6778|\n+---+-----+---+----+------------------+-----+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291824389,"submitTime":1500291812703,"finishTime":1500291829920,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8fa06e1d-be61-45e5-98d8-c110dad65664"},{"version":"CommandV1","origId":3170457594604159,"guid":"bbde54dc-54d6-4c85-b67e-e877861bd5f1","subtype":"command","commandType":"auto","position":7.0,"command":"data2=sqlContext.sql(\"Select day ,month,dow ,first(description) as desc, avg(float(temperature)) as temperature ,sum(fw) as count from joineddata where hour>=12 and hour<17 group by day,month,dow order by avg(temperature)\")\ndata2.show()","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-----+---+----+-------------------+-----+\n|day|month|dow|desc|        temperature|count|\n+---+-----+---+----+-------------------+-----+\n| 11|    1|  2|  18|-0.3079999886453152| 6239|\n| 10|    1|  1|  18|0.18399999737739564| 5437|\n|  8|    1|  6|  20| 0.9950000047683716|12917|\n|  7|    1|  5|  19| 1.5575000047683716|15037|\n| 12|    1|  3|  14|  1.637499988079071| 4943|\n| 13|    1|  4|  14|  2.414000004529953| 6178|\n|354|   12|  0|   8| 2.5020000457763674| 9033|\n|  9|    1|  0|  20| 2.7224999964237213| 5144|\n| 41|    2|  4|  16|   2.89399995803833| 3180|\n| 25|    1|  2|  20|  3.049999952316284| 2773|\n|349|   12|  2|  13| 3.4099999904632567| 9286|\n|350|   12|  3|  13| 3.4419999599456785| 9048|\n|347|   12|  0|  13| 3.5480000495910646| 8474|\n|353|   12|  6|  14| 3.6299999713897706|25425|\n|  6|    1|  4|  20|   3.92249995470047|14037|\n| 36|    2|  6|   8|  3.939999997615814| 2568|\n| 20|    1|  4|  20| 4.0333333015441895| 3641|\n|348|   12|  1|  13| 4.1999999523162845| 9704|\n|351|   12|  4|  14| 4.2779998779296875| 9711|\n| 27|    1|  4|  14|   4.29749995470047| 3559|\n+---+-----+---+----+-------------------+-----+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291829923,"submitTime":1500291812715,"finishTime":1500291836476,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f57ea155-b737-4029-9976-49c76c4df0cb"},{"version":"CommandV1","origId":3170457594604160,"guid":"543056bb-8b97-4ae2-a4db-ca864a74bde9","subtype":"command","commandType":"auto","position":8.0,"command":"display(data2)","commandVersion":1,"state":"finished","results":{"type":"table","data":[[11,1,2,18,-0.3079999886453152,6239],[10,1,1,18,0.18399999737739564,5437],[8,1,6,20,0.9950000047683716,12917],[7,1,5,19,1.5575000047683716,15037],[12,1,3,14,1.637499988079071,4943],[13,1,4,14,2.414000004529953,6178],[354,12,0,8,2.5020000457763674,9033],[9,1,0,20,2.7224999964237213,5144],[41,2,4,16,2.89399995803833,3180],[25,1,2,20,3.049999952316284,2773],[349,12,2,13,3.4099999904632567,9286],[350,12,3,13,3.4419999599456785,9048],[347,12,0,13,3.5480000495910646,8474],[353,12,6,14,3.6299999713897706,25425],[6,1,4,20,3.92249995470047,14037],[36,2,6,8,3.939999997615814,2568],[20,1,4,20,4.0333333015441895,3641],[348,12,1,13,4.1999999523162845,9704],[351,12,4,14,4.2779998779296875,9711],[27,1,4,14,4.29749995470047,3559],[16,1,0,19,4.383999919891357,5805],[18,1,2,20,4.4100000858306885,7231],[352,12,5,13,4.612000036239624,22743],[28,1,5,14,4.635999965667724,7376],[31,1,1,14,4.817499876022339,3101],[26,1,3,20,5.109999974568685,2714],[32,2,2,14,5.180000066757202,3277],[42,2,5,14,5.4679999351501465,6875],[19,1,3,20,5.524999976158142,5786],[17,1,1,20,5.526666482289632,4255],[30,1,0,14,5.559999942779541,3872],[21,1,5,20,5.627500057220459,6381],[2,1,0,20,5.765999984741211,14591],[29,1,6,14,5.78799991607666,6882],[33,2,3,8,5.796666622161865,1774],[334,11,1,18,5.7999999046325685,8125],[40,2,3,8,5.8399999141693115,3267],[35,2,5,9,6.105999851226807,5064],[15,1,6,20,6.183333237965901,7502],[39,2,2,14,6.302499890327454,3202],[365,12,4,20,6.331999969482422,16556],[366,12,5,20,6.36399998664856,15866],[14,1,5,19,6.384999990463257,10783],[1,1,6,20,6.415000021457672,17892],[345,12,5,14,6.573999977111816,26284],[335,11,2,20,6.614000034332276,8553],[344,12,4,14,6.6159998893737795,17376],[34,2,4,5,6.741999912261963,3727],[5,1,3,19,6.773999977111816,11992],[343,12,3,20,6.888000011444092,30028],[4,1,2,20,6.9100000858306885,10317],[355,12,1,9,6.984000015258789,9871],[320,11,1,18,7.05600004196167,7696],[44,2,0,14,7.06200008392334,4201],[22,1,6,20,7.164999842643738,6549],[59,2,1,8,7.238000011444091,3489],[364,12,3,18,7.309999942779541,11979],[346,12,6,14,7.43799991607666,25117],[51,2,0,18,7.44399995803833,4251],[338,12,5,14,7.5479999542236325,18475],[342,12,2,14,7.676000118255615,12269],[322,11,3,14,7.688000106811524,7790],[43,2,6,14,7.750000095367431,5716],[23,1,0,20,7.867500066757202,3343],[323,11,4,14,8.003999996185303,7944],[359,12,5,20,8.118000030517578,13019],[314,11,2,20,8.16200008392334,4773],[54,2,3,14,8.17799997329712,4160],[324,11,5,9,8.193999862670898,11253],[62,3,4,5,8.197999954223633,4373],[339,12,6,14,8.355999851226807,21164],[45,2,1,20,8.404000091552735,4916],[49,2,5,18,8.454000091552734,8529],[341,12,1,14,8.519999885559082,9940],[3,1,1,20,8.56499981880188,12016],[325,11,6,14,8.581999969482421,12574],[316,11,4,14,8.627999973297118,9037],[321,11,2,14,8.742000102996826,8351],[319,11,0,18,8.760000038146973,7091],[121,5,0,7,8.785999870300293,7392],[357,12,3,13,8.886000061035157,14933],[50,2,6,20,8.943999671936036,7447],[340,12,0,14,9.015999794006348,9561],[358,12,4,13,9.202000045776368,11128],[63,3,5,8,9.307999992370606,4813],[336,12,3,20,9.364000129699708,9923],[53,2,2,13,9.376000022888183,4426],[24,1,1,20,9.409999966621399,3678],[326,11,0,7,9.46666685740153,2708],[48,2,4,20,9.569999694824219,5045],[46,2,2,20,9.72199993133545,5129],[360,12,6,19,9.776000213623046,4580],[315,11,3,20,9.870000076293945,8395],[310,11,5,9,9.92199993133545,5927],[287,10,3,9,10.06200008392334,8090],[285,10,1,9,10.068000030517577,6162],[288,10,4,7,10.161999893188476,7373],[318,11,6,18,10.245999908447265,19337],[47,2,3,20,10.3560001373291,4973],[38,2,1,19,10.370000076293945,4289],[52,2,1,19,10.42199993133545,4520],[311,11,6,14,10.476000022888183,4681],[356,12,2,19,10.62599983215332,12839],[363,12,2,20,10.74750018119812,14840],[56,2,5,19,10.789999961853027,9036],[333,11,0,14,10.894000053405762,7852],[361,12,0,20,11.102000045776368,14622],[55,2,4,14,11.1060001373291,4613],[37,2,0,18,11.125,3310],[65,3,0,18,11.168000030517579,4359],[313,11,1,20,11.18799991607666,5145],[58,2,0,19,11.211999893188477,5707],[327,11,1,7,11.313999938964844,5567],[116,4,2,7,11.342000198364257,2550],[297,10,6,9,11.355999946594238,8676],[286,10,2,20,11.444000053405762,11187],[57,2,6,20,11.49199981689453,10766],[296,10,5,18,11.599999809265137,19307],[332,11,6,20,11.76599998474121,25578],[330,11,4,9,11.992499828338623,5289],[295,10,4,20,12.051999855041505,11151],[64,3,6,18,12.210000228881835,7383],[85,3,6,18,12.270000076293945,6778],[283,10,6,9,12.292000007629394,6735],[329,11,3,5,12.40399990081787,6923],[123,5,2,5,12.42400016784668,5067],[312,11,0,19,12.539999771118165,4943],[328,11,2,5,12.556000137329102,6433],[337,12,4,20,12.604000091552734,10690],[86,3,0,18,12.644000053405762,4759],[82,3,3,14,12.711999893188477,3746],[298,10,0,17,12.750000381469727,8188],[81,3,2,14,12.814000129699707,4073],[284,10,0,18,12.819999885559081,6183],[302,10,4,9,12.877999687194825,10567],[117,4,3,7,12.90999984741211,4964],[309,11,4,18,12.91599998474121,5770],[83,3,4,8,13.046000289916993,4431],[72,3,0,20,13.183999824523926,4550],[293,10,2,9,13.193999862670898,9317],[317,11,5,20,13.233999633789063,19600],[109,4,2,19,13.305999946594238,7417],[299,10,1,7,13.371999931335449,7615],[306,11,1,18,13.417999839782714,18912],[331,11,5,19,13.454000091552734,18595],[118,4,4,18,13.600000190734864,11667],[61,3,3,19,13.722000122070312,5498],[114,4,0,17,13.75800018310547,15903],[108,4,1,19,13.759999847412109,7073],[71,3,6,20,13.8,8977],[294,10,3,18,13.819999885559081,10955],[124,5,3,8,13.82199993133545,5561],[305,10,0,9,13.85,17620],[307,11,2,14,14.092000198364257,8555],[111,4,4,20,14.099999809265137,11905],[60,3,2,19,14.135999870300292,5116],[126,5,5,5,14.385999870300292,8934],[127,5,6,9,14.395999908447266,7970],[67,3,2,20,14.402000045776367,5049],[80,3,1,14,14.545999908447266,4540],[291,10,0,17,14.579999923706055,9679],[115,4,1,5,14.597999954223633,12653],[303,10,5,20,14.59800033569336,20226],[301,10,3,20,14.658000183105468,9754],[66,3,1,19,14.951999855041503,4836],[308,11,3,14,14.953999710083007,6141],[70,3,5,20,15.047999954223632,9972],[131,5,3,9,15.047999954223632,6376],[280,10,3,20,15.058000183105468,11061],[87,3,1,20,15.084000205993652,4818],[110,4,3,20,15.227999877929687,11401],[300,10,2,17,15.307999801635741,9263],[289,10,5,19,15.444000244140625,14906],[120,4,6,18,15.510000038146973,26668],[74,3,2,18,15.560000038146972,4686],[122,5,1,20,15.615999984741212,5904],[304,10,6,20,15.654000282287598,21866],[119,4,5,19,15.659999656677247,22741],[95,4,2,18,15.869999885559082,5678],[107,4,0,18,15.922000122070312,16601],[97,4,4,20,15.955999946594238,9346],[290,10,6,18,16.020000076293947,20647],[79,3,0,14,16.243999671936034,4624],[292,10,1,20,16.29000053405762,10282],[73,3,1,20,16.299999809265138,4878],[92,4,6,18,16.42400016784668,7475],[265,9,2,7,16.445000171661377,7962],[68,3,3,20,16.481999969482423,5032],[281,10,4,20,16.563999938964844,7004],[282,10,5,20,16.598000717163085,12173],[75,3,3,14,16.63600025177002,5299],[130,5,2,18,17.03799991607666,6341],[362,12,1,20,17.50749969482422,13656],[112,4,5,20,17.552000045776367,20158],[125,5,4,19,17.69199981689453,6592],[76,3,4,14,17.96800003051758,5758],[139,5,4,9,18.00800018310547,6130],[77,3,5,19,18.167999839782716,9833],[84,3,5,19,18.591999816894532,10529],[98,4,5,20,18.60200023651123,10722],[113,4,6,8,18.80399990081787,20331],[91,4,5,18,18.80799980163574,10076],[102,4,2,18,18.98400001525879,5837],[279,10,2,20,19.383999633789063,12185],[96,4,3,20,19.518000030517577,9998],[104,4,4,19,19.64600028991699,11031],[88,3,2,20,19.731999969482423,5306],[78,3,6,18,19.854000091552734,10010],[93,4,0,19,19.878000259399414,5190],[128,5,0,18,19.882000350952147,6340],[278,10,1,20,19.886000061035155,12128],[94,4,1,18,20.071999740600585,5525],[103,4,3,20,20.231999588012695,9886],[105,4,5,19,20.243999862670897,16062],[89,3,3,20,20.51400032043457,5316],[275,10,5,9,20.536000442504882,19219],[266,9,3,19,20.567999649047852,11782],[90,3,4,20,20.611999893188475,5934],[129,5,1,19,20.681999969482423,5930],[69,3,4,20,20.719999694824217,5619],[276,10,6,18,20.87400016784668,18440],[262,9,6,9,20.897999954223632,18361],[259,9,3,18,20.915999984741212,12723],[260,9,4,5,20.989999771118164,11879],[140,5,5,5,21.0379997253418,9802],[106,4,6,19,21.75199966430664,13362],[267,9,4,19,21.936000061035156,12734],[101,4,1,18,21.960000038146973,2527],[274,9,4,18,22.163999938964842,11836],[268,9,5,20,22.247999954223634,21101],[277,10,0,20,22.296000289916993,11869],[269,9,6,20,22.35,18795],[261,9,5,9,22.408000183105468,23946],[243,8,1,18,22.5560001373291,12092],[271,9,1,19,22.795000076293945,10806],[270,9,0,20,22.928000259399415,11670],[272,9,2,20,22.94600028991699,11553],[141,5,6,20,23.12400016784668,9505],[273,9,3,20,23.17400016784668,12492],[138,5,3,18,23.604000091552734,6169],[136,5,1,19,23.613999557495116,5867],[213,7,6,7,23.97599983215332,10433],[264,9,1,17,24.123999404907227,13548],[142,5,0,19,24.15999984741211,6379],[225,8,4,19,24.57999954223633,9277],[224,8,3,20,24.744000244140626,9806],[263,9,0,20,24.92600021362305,14765],[137,5,2,19,25.10199966430664,5978],[143,5,1,20,25.520000076293947,6377],[235,8,0,20,26.034000396728516,7754],[231,8,3,18,26.13400001525879,10073],[214,8,0,18,26.199999809265137,7548],[226,8,5,20,26.331999588012696,10821],[251,9,2,20,26.68400001525879,13810],[236,8,1,20,26.817999649047852,8407],[144,5,2,19,27.065999603271486,5934],[215,8,1,18,27.1,9916],[244,8,2,19,27.202000045776366,11546],[210,7,3,9,27.252000045776366,10463],[230,8,2,18,27.30800018310547,8435],[249,9,0,19,27.444000244140625,13264],[252,9,3,19,27.48200035095215,15383],[227,8,6,19,27.677999877929686,9632],[239,8,4,18,27.738000106811523,8839],[237,8,2,20,27.75999984741211,7675],[250,9,1,20,27.762000274658202,15078],[209,7,2,2,27.86400032043457,8791],[256,9,0,19,27.871999740600586,13204],[229,8,1,20,28.107999801635742,9744],[216,8,2,19,28.219999694824217,8630],[238,8,3,19,28.319999313354494,8267],[253,9,4,20,28.322000122070314,14918],[248,9,6,18,28.350000381469727,16425],[245,9,3,19,28.360000228881837,12541],[255,9,6,19,28.536000061035157,17590],[254,9,5,20,28.64600028991699,15231],[247,9,5,19,28.742000579833984,18036],[257,9,1,19,28.871999740600586,12974],[240,8,5,19,28.88799934387207,8982],[242,8,0,19,29.020000076293947,5899],[211,7,4,18,29.02400016784668,8125],[258,9,2,19,29.085000038146973,9625],[246,9,4,19,29.089999771118165,13917],[228,8,0,19,29.144000244140624,10672],[241,8,6,19,29.726000213623045,7316],[212,7,5,18,29.731999588012695,10908],[217,8,3,9,29.745999908447267,9133],[208,7,1,18,29.76799964904785,7680],[207,7,0,19,30.579999923706055,3597]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"day","type":"\"long\"","metadata":"{}"},{"name":"month","type":"\"long\"","metadata":"{}"},{"name":"dow","type":"\"long\"","metadata":"{}"},{"name":"desc","type":"\"long\"","metadata":"{}"},{"name":"temperature","type":"\"double\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291836478,"submitTime":1500291812727,"finishTime":1500291843389,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e5f50d02-6114-430d-aa14-2b1b59072133"},{"version":"CommandV1","origId":3170457594604161,"guid":"c9b448ad-f449-4fc6-94a3-22276c9d34dc","subtype":"command","commandType":"auto","position":9.0,"command":"dataRDD=data.rdd.map(lambda x:(int(x[0]),int(x[1]),int(x[2]),float(x[4]),int(x[5])))\n","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291843402,"submitTime":1500291812743,"finishTime":1500291843525,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f4f344be-bf4e-429e-8235-66c919d0c964"},{"version":"CommandV1","origId":3170457594604162,"guid":"92731020-2b50-45be-bb4c-14f015c23e80","subtype":"command","commandType":"auto","position":10.0,"command":"dataRDD.take(5)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">10</span><span class=\"ansired\">]: </span>\n[(42, 2, 5, 5.4679999351501465, 6875),\n (45, 2, 1, 8.404000091552735, 4916),\n (271, 9, 1, 22.795000076293945, 10806),\n (50, 2, 6, 8.943999671936036, 7447),\n (351, 12, 4, 4.2779998779296875, 9711)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291843528,"submitTime":1500291812753,"finishTime":1500291847957,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ae24174a-2b9f-499f-a885-082781e7124f"},{"version":"CommandV1","origId":3170457594604163,"guid":"a10d57e6-362b-4bb9-9383-2f6a8b2349d7","subtype":"command","commandType":"auto","position":11.0,"command":"df1 = sqlContext.createDataFrame(dataRDD, schema=['doy','month', 'dow', 'temperature','count'])\ndf2 = sqlContext.createDataFrame(descCalc, schema=['doy','desc'])\nrdd_join = df1.join(df2, on=['doy'])\ntotalRDD = rdd_join.rdd\ntotalRDD.take(5)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">11</span><span class=\"ansired\">]: </span>\n[Row(doy=26, month=1, dow=3, temperature=5.109999974568685, count=2714, desc=20),\n Row(doy=29, month=1, dow=6, temperature=5.78799991607666, count=6882, desc=14),\n Row(doy=65, month=3, dow=0, temperature=11.168000030517579, count=4359, desc=20),\n Row(doy=270, month=9, dow=0, temperature=22.928000259399415, count=11670, desc=20),\n Row(doy=293, month=10, dow=2, temperature=13.193999862670898, count=9317, desc=9)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291847960,"submitTime":1500291812764,"finishTime":1500291849972,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"59f4939e-ae1c-4c47-8ecf-6ead2498db22"},{"version":"CommandV1","origId":3170457594604164,"guid":"5609f60c-39c7-4445-beba-1ca84f721a44","subtype":"command","commandType":"auto","position":12.0,"command":"totalRDD=totalRDD.map(lambda x:(x[0],x[1],x[2],x[3],x[5],x[4]))\ntotalRDD2=totalRDD.map(lambda x:x)\ntotalRDD.take(5)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">12</span><span class=\"ansired\">]: </span>\n[(26, 1, 3, 5.109999974568685, 20, 2714),\n (29, 1, 6, 5.78799991607666, 14, 6882),\n (65, 3, 0, 11.168000030517579, 20, 4359),\n (270, 9, 0, 22.928000259399415, 20, 11670),\n (293, 10, 2, 13.193999862670898, 9, 9317)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291849975,"submitTime":1500291812775,"finishTime":1500291850148,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c29eedeb-b302-4f02-a5b6-f8c19fb43472"},{"version":"CommandV1","origId":3170457594604165,"guid":"8dcd77dd-4ff2-4611-a175-2713d1869cd1","subtype":"command","commandType":"auto","position":13.0,"command":"monthAverages=sqlContext.sql(\"Select month , sum(fw)/count(distinct(day)) as avg from joineddata where dow>=0 and dow<=4 and  hour>=12 and hour<17 group by month\")\nmonthAverages.show()","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+------------------+\n|month|               avg|\n+-----+------------------+\n|    7|            7731.2|\n|    9|12657.454545454546|\n|    5|         6146.0625|\n|    1| 6393.272727272727|\n|   10| 9887.285714285714|\n|    3| 4895.652173913043|\n|   12|12521.227272727272|\n|    8| 9095.166666666666|\n|   11| 7363.318181818182|\n|    2|            4072.8|\n|    4| 8797.473684210527|\n+-----+------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291850151,"submitTime":1500291812786,"finishTime":1500291856084,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"38f9457f-179a-49ac-93ef-3f005c913267"},{"version":"CommandV1","origId":3170457594604166,"guid":"8fb7954b-2495-4352-915e-b2b4bc3def4a","subtype":"command","commandType":"auto","position":14.0,"command":"monthRDD=monthAverages.rdd.map(lambda x:(int(x[0]),float(x[1])))\nmonthRDD.take(11)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">14</span><span class=\"ansired\">]: </span>\n[(7, 7731.2),\n (9, 12657.454545454546),\n (5, 6146.0625),\n (1, 6393.272727272727),\n (10, 9887.285714285714),\n (3, 4895.652173913043),\n (12, 12521.227272727272),\n (8, 9095.166666666666),\n (11, 7363.318181818182),\n (2, 4072.8),\n (4, 8797.473684210527)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291856088,"submitTime":1500291812796,"finishTime":1500291865242,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"63e22bea-b9dc-4b6b-ab45-c2608fdfd9b9"},{"version":"CommandV1","origId":3170457594604167,"guid":"d1345eb9-aac7-4c29-8c0a-2c0ad5b7fcb2","subtype":"command","commandType":"auto","position":15.0,"command":"df1 = sqlContext.createDataFrame(totalRDD, schema=['doy','month', 'dow', 'temperature','desc','count'])\ndf2 = sqlContext.createDataFrame(monthRDD, schema=['month','threshold'])\nrdd_join = df1.join(df2, on=['month'])\ntotalRDD = rdd_join.rdd\ntotalRDD.take(5)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">16</span><span class=\"ansired\">]: </span>\n[Row(month=7, doy=212, dow=5, temperature=29.731999588012695, desc=18, count=10908, threshold=7731.2),\n Row(month=7, doy=209, dow=2, temperature=27.86400032043457, desc=9, count=8791, threshold=7731.2),\n Row(month=7, doy=208, dow=1, temperature=29.76799964904785, desc=18, count=7680, threshold=7731.2),\n Row(month=7, doy=207, dow=0, temperature=30.579999923706055, desc=19, count=3597, threshold=7731.2),\n Row(month=7, doy=210, dow=3, temperature=27.252000045776366, desc=19, count=10463, threshold=7731.2)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291869069,"submitTime":1500291812817,"finishTime":1500291872692,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"92551f05-de96-4d5f-99b3-402669d3c046"},{"version":"CommandV1","origId":3170457594604168,"guid":"4f7b629d-3afe-4e6e-b5a5-21d2a4c2b4f7","subtype":"command","commandType":"auto","position":16.0,"command":"totalRDD=totalRDD.map(lambda x:(x[1],x[0],x[2],x[3],x[4],x[5],x[6]))\ntotalRDD2=totalRDD2.map(lambda x:(x[1],x[0],x[2],x[3],x[4],x[5],x[6]))\ntotalRDD.take(5)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">18</span><span class=\"ansired\">]: </span>\n[(212, 7, 5, 29.731999588012695, 18, 10908, 7731.2),\n (209, 7, 2, 27.86400032043457, 9, 8791, 7731.2),\n (208, 7, 1, 29.76799964904785, 18, 7680, 7731.2),\n (207, 7, 0, 30.579999923706055, 19, 3597, 7731.2),\n (210, 7, 3, 27.252000045776366, 19, 10463, 7731.2)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291880640,"submitTime":1500291812837,"finishTime":1500291881012,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8cffe935-3f28-418a-a6b3-2caa962f7d05"},{"version":"CommandV1","origId":3170457594604169,"guid":"54f6e4a7-49c2-4add-8af9-897d8e42cf5c","subtype":"command","commandType":"auto","position":17.0,"command":"labeledRDD=totalRDD.map(lambda x:(x[0],x[1],x[2],x[3],x[4],x[5],x[5]>=1.25*x[6]))\nlabeledRDD2=totalRDD2.map(lambda x:(x[0],x[1],x[2],x[3],x[4],x[5],x[5]>=x[6]))\nlabeledRDD.take(10)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">19</span><span class=\"ansired\">]: </span>\n[(212, 7, 5, 29.731999588012695, 18, 10908, True),\n (209, 7, 2, 27.86400032043457, 9, 8791, False),\n (208, 7, 1, 29.76799964904785, 18, 7680, False),\n (207, 7, 0, 30.579999923706055, 19, 3597, False),\n (210, 7, 3, 27.252000045776366, 19, 10463, True),\n (213, 7, 6, 23.97599983215332, 7, 10433, True),\n (211, 7, 4, 29.02400016784668, 18, 8125, False),\n (270, 9, 0, 22.928000259399415, 20, 11670, False),\n (274, 9, 4, 22.163999938964842, 18, 11836, False),\n (262, 9, 6, 20.897999954223632, 5, 18361, True)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291881015,"submitTime":1500291812847,"finishTime":1500291881638,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8dc21c65-8ead-4c15-8e22-6508637de5ad"},{"version":"CommandV1","origId":3170457594604170,"guid":"b54798fc-4daa-454e-ac31-14493b560e29","subtype":"command","commandType":"auto","position":18.0,"command":"labeledDF = sqlContext.createDataFrame(labeledRDD, schema=['doy','month', 'dow', 'temperature','desc','count','label'])\nlabeledDF2 = sqlContext.createDataFrame(labeledRDD2, schema=['doy','month', 'dow', 'temperature','desc','count','label'])\nlabeledDF.show()","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-----+---+------------------+----+-----+-----+\n|doy|month|dow|       temperature|desc|count|label|\n+---+-----+---+------------------+----+-----+-----+\n|212|    7|  5|29.731999588012695|  18|10908| true|\n|209|    7|  2| 27.86400032043457|   9| 8791|false|\n|208|    7|  1| 29.76799964904785|  18| 7680|false|\n|207|    7|  0|30.579999923706055|  19| 3597|false|\n|210|    7|  3|27.252000045776366|  19|10463| true|\n|213|    7|  6| 23.97599983215332|   7|10433| true|\n|211|    7|  4| 29.02400016784668|  18| 8125|false|\n|270|    9|  0|22.928000259399415|  20|11670|false|\n|274|    9|  4|22.163999938964842|  18|11836|false|\n|262|    9|  6|20.897999954223632|   5|18361| true|\n|264|    9|  1|24.123999404907227|  19|13548|false|\n|268|    9|  5|22.247999954223634|  20|21101| true|\n|255|    9|  6|28.536000061035157|  20|17590| true|\n|258|    9|  2|29.085000038146973|  20| 9625|false|\n|266|    9|  3|20.567999649047852|  18|11782|false|\n|271|    9|  1|22.795000076293945|  20|10806|false|\n|253|    9|  4|28.322000122070314|  20|14918|false|\n|246|    9|  4|29.089999771118165|  18|13917|false|\n|248|    9|  6|28.350000381469727|  19|16425| true|\n|257|    9|  1|28.871999740600586|  19|12974|false|\n+---+-----+---+------------------+----+-----+-----+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291881641,"submitTime":1500291812856,"finishTime":1500291883252,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9e783835-f9c3-44d4-8b0b-0381bb6b7de8"},{"version":"CommandV1","origId":3170457594604171,"guid":"35d63839-8c0f-47b1-bc95-9d3810b3e614","subtype":"command","commandType":"auto","position":19.0,"command":"display(labeledDF\n       )","commandVersion":1,"state":"finished","results":{"type":"table","data":[[212,7,5,29.731999588012695,18,10908,true],[209,7,2,27.86400032043457,9,8791,false],[208,7,1,29.76799964904785,18,7680,false],[207,7,0,30.579999923706055,19,3597,false],[210,7,3,27.252000045776366,19,10463,true],[213,7,6,23.97599983215332,7,10433,true],[211,7,4,29.02400016784668,18,8125,false],[270,9,0,22.928000259399415,20,11670,false],[274,9,4,22.163999938964842,18,11836,false],[262,9,6,20.897999954223632,5,18361,true],[264,9,1,24.123999404907227,19,13548,false],[268,9,5,22.247999954223634,20,21101,true],[255,9,6,28.536000061035157,20,17590,true],[258,9,2,29.085000038146973,20,9625,false],[266,9,3,20.567999649047852,18,11782,false],[271,9,1,22.795000076293945,20,10806,false],[253,9,4,28.322000122070314,20,14918,false],[246,9,4,29.089999771118165,18,13917,false],[248,9,6,28.350000381469727,19,16425,true],[257,9,1,28.871999740600586,19,12974,false],[250,9,1,27.762000274658202,20,15078,false],[252,9,3,27.48200035095215,19,15383,false],[254,9,5,28.64600028991699,20,15231,false],[247,9,5,28.742000579833984,19,18036,true],[249,9,0,27.444000244140625,18,13264,false],[260,9,4,20.989999771118164,5,11879,false],[269,9,6,22.35,20,18795,true],[265,9,2,16.445000171661377,7,7962,false],[245,9,3,28.360000228881837,18,12541,false],[272,9,2,22.94600028991699,20,11553,false],[256,9,0,27.871999740600586,19,13204,false],[251,9,2,26.68400001525879,20,13810,false],[259,9,3,20.915999984741212,5,12723,false],[263,9,0,24.92600021362305,20,14765,false],[267,9,4,21.936000061035156,19,12734,false],[261,9,5,22.408000183105468,9,23946,true],[273,9,3,23.17400016784668,20,12492,false],[130,5,2,17.03799991607666,18,6341,false],[126,5,5,14.385999870300292,18,8934,true],[136,5,1,23.613999557495116,20,5867,false],[144,5,2,27.065999603271486,20,5934,false],[124,5,3,13.82199993133545,8,5561,false],[143,5,1,25.520000076293947,20,6377,false],[139,5,4,18.00800018310547,7,6130,false],[138,5,3,23.604000091552734,18,6169,false],[128,5,0,19.882000350952147,5,6340,false],[142,5,0,24.15999984741211,19,6379,false],[131,5,3,15.047999954223632,8,6376,false],[123,5,2,12.42400016784668,8,5067,false],[127,5,6,14.395999908447266,14,7970,true],[141,5,6,23.12400016784668,20,9505,true],[125,5,4,17.69199981689453,14,6592,false],[140,5,5,21.0379997253418,18,9802,true],[137,5,2,25.10199966430664,19,5978,false],[122,5,1,15.615999984741212,20,5904,false],[129,5,1,20.681999969482423,20,5930,false],[121,5,0,8.785999870300293,7,7392,false],[26,1,3,5.109999974568685,20,2714,false],[29,1,6,5.78799991607666,14,6882,false],[19,1,3,5.524999976158142,20,5786,false],[22,1,6,7.164999842643738,20,6549,false],[7,1,5,1.5575000047683716,20,15037,true],[31,1,1,4.817499876022339,14,3101,false],[25,1,2,3.049999952316284,20,2773,false],[6,1,4,3.92249995470047,20,14037,true],[9,1,0,2.7224999964237213,20,5144,false],[27,1,4,4.29749995470047,18,3559,false],[17,1,1,5.526666482289632,20,4255,false],[28,1,5,4.635999965667724,14,7376,false],[5,1,3,6.773999977111816,18,11992,true],[1,1,6,6.415000021457672,13,17892,true],[10,1,1,0.18399999737739564,18,5437,false],[3,1,1,8.56499981880188,20,12016,true],[12,1,3,1.637499988079071,14,4943,false],[8,1,6,0.9950000047683716,19,12917,true],[11,1,2,-0.3079999886453152,18,6239,false],[2,1,0,5.765999984741211,14,14591,true],[4,1,2,6.9100000858306885,20,10317,true],[13,1,4,2.414000004529953,14,6178,false],[18,1,2,4.4100000858306885,20,7231,false],[14,1,5,6.384999990463257,20,10783,true],[21,1,5,5.627500057220459,20,6381,false],[15,1,6,6.183333237965901,20,7502,false],[30,1,0,5.559999942779541,14,3872,false],[23,1,0,7.867500066757202,20,3343,false],[20,1,4,4.0333333015441895,20,3641,false],[16,1,0,4.383999919891357,20,5805,false],[24,1,1,9.409999966621399,20,3678,false],[293,10,2,13.193999862670898,9,9317,false],[278,10,1,19.886000061035155,20,12128,false],[296,10,5,11.599999809265137,9,19307,true],[277,10,0,22.296000289916993,9,11869,false],[287,10,3,10.06200008392334,9,8090,false],[299,10,1,13.371999931335449,7,7615,false],[275,10,5,20.536000442504882,9,19219,true],[279,10,2,19.383999633789063,20,12185,false],[276,10,6,20.87400016784668,9,18440,true],[304,10,6,15.654000282287598,20,21866,true],[301,10,3,14.658000183105468,18,9754,false],[294,10,3,13.819999885559081,20,10955,false],[303,10,5,14.59800033569336,20,20226,true],[283,10,6,12.292000007629394,9,6735,false],[292,10,1,16.29000053405762,20,10282,false],[295,10,4,12.051999855041505,20,11151,false],[288,10,4,10.161999893188476,7,7373,false],[280,10,3,15.058000183105468,18,11061,false],[290,10,6,16.020000076293947,20,20647,true],[305,10,0,13.85,9,17620,true],[302,10,4,12.877999687194825,9,10567,false],[298,10,0,12.750000381469727,9,8188,false],[289,10,5,15.444000244140625,18,14906,true],[286,10,2,11.444000053405762,20,11187,false],[297,10,6,11.355999946594238,9,8676,false],[291,10,0,14.579999923706055,9,9679,false],[284,10,0,12.819999885559081,20,6183,false],[300,10,2,15.307999801635741,18,9263,false],[282,10,5,16.598000717163085,19,12173,false],[285,10,1,10.068000030517577,9,6162,false],[281,10,4,16.563999938964844,20,7004,false],[65,3,0,11.168000030517579,20,4359,false],[77,3,5,18.167999839782716,14,9833,true],[84,3,5,18.591999816894532,19,10529,true],[71,3,6,13.8,20,8977,true],[68,3,3,16.481999969482423,20,5032,false],[72,3,0,13.183999824523926,20,4550,false],[87,3,1,15.084000205993652,20,4818,false],[63,3,5,9.307999992370606,8,4813,false],[79,3,0,16.243999671936034,14,4624,false],[88,3,2,19.731999969482423,20,5306,false],[89,3,3,20.51400032043457,20,5316,false],[85,3,6,12.270000076293945,18,6778,true],[67,3,2,14.402000045776367,20,5049,false],[61,3,3,13.722000122070312,20,5498,false],[83,3,4,13.046000289916993,9,4431,false],[74,3,2,15.560000038146972,20,4686,false],[62,3,4,8.197999954223633,5,4373,false],[80,3,1,14.545999908447266,14,4540,false],[66,3,1,14.951999855041503,20,4836,false],[76,3,4,17.96800003051758,14,5758,false],[75,3,3,16.63600025177002,14,5299,false],[78,3,6,19.854000091552734,18,10010,true],[69,3,4,20.719999694824217,20,5619,false],[81,3,2,12.814000129699707,5,4073,false],[82,3,3,12.711999893188477,5,3746,false],[73,3,1,16.299999809265138,20,4878,false],[90,3,4,20.611999893188475,20,5934,false],[70,3,5,15.047999954223632,20,9972,true],[86,3,0,12.644000053405762,18,4759,false],[60,3,2,14.135999870300292,20,5116,false],[64,3,6,12.210000228881835,18,7383,true],[348,12,1,4.1999999523162845,13,9704,false],[347,12,0,3.5480000495910646,13,8474,false],[343,12,3,6.888000011444092,13,30028,true],[363,12,2,10.74750018119812,20,14840,false],[365,12,4,6.331999969482422,20,16556,true],[342,12,2,7.676000118255615,13,12269,false],[353,12,6,3.6299999713897706,13,25425,true],[341,12,1,8.519999885559082,14,9940,false],[346,12,6,7.43799991607666,14,25117,true],[349,12,2,3.4099999904632567,13,9286,false],[361,12,0,11.102000045776368,14,14622,false],[364,12,3,7.309999942779541,18,11979,false],[356,12,2,10.62599983215332,18,12839,false],[339,12,6,8.355999851226807,14,21164,true],[345,12,5,6.573999977111816,13,26284,true],[352,12,5,4.612000036239624,13,22743,true],[337,12,4,12.604000091552734,20,10690,false],[362,12,1,17.50749969482422,20,13656,false],[355,12,1,6.984000015258789,8,9871,false],[344,12,4,6.6159998893737795,13,17376,true],[360,12,6,9.776000213623046,13,4580,false],[359,12,5,8.118000030517578,20,13019,false],[350,12,3,3.4419999599456785,13,9048,false],[351,12,4,4.2779998779296875,14,9711,false],[338,12,5,7.5479999542236325,14,18475,true],[358,12,4,9.202000045776368,13,11128,false],[354,12,0,2.5020000457763674,8,9033,false],[366,12,5,6.36399998664856,20,15866,true],[336,12,3,9.364000129699708,20,9923,false],[357,12,3,8.886000061035157,13,14933,false],[340,12,0,9.015999794006348,14,9561,false],[243,8,1,22.5560001373291,9,12092,true],[237,8,2,27.75999984741211,20,7675,false],[241,8,6,29.726000213623045,19,7316,false],[228,8,0,29.144000244140624,19,10672,false],[229,8,1,28.107999801635742,20,9744,false],[227,8,6,27.677999877929686,20,9632,false],[215,8,1,27.1,18,9916,false],[239,8,4,27.738000106811523,18,8839,false],[236,8,1,26.817999649047852,20,8407,false],[226,8,5,26.331999588012696,20,10821,false],[242,8,0,29.020000076293947,19,5899,false],[235,8,0,26.034000396728516,20,7754,false],[214,8,0,26.199999809265137,18,7548,false],[224,8,3,24.744000244140626,19,9806,false],[225,8,4,24.57999954223633,20,9277,false],[244,8,2,27.202000045776366,19,11546,true],[230,8,2,27.30800018310547,18,8435,false],[216,8,2,28.219999694824217,19,8630,false],[238,8,3,28.319999313354494,18,8267,false],[217,8,3,29.745999908447267,20,9133,false],[231,8,3,26.13400001525879,18,10073,false],[240,8,5,28.88799934387207,19,8982,false],[330,11,4,11.992499828338623,7,5289,false],[325,11,6,8.581999969482421,13,12574,true],[326,11,0,9.46666685740153,7,2708,false],[320,11,1,7.05600004196167,17,7696,false],[316,11,4,8.627999973297118,14,9037,false],[307,11,2,14.092000198364257,14,8555,false],[319,11,0,8.760000038146973,18,7091,false],[328,11,2,12.556000137329102,8,6433,false],[332,11,6,11.76599998474121,20,25578,true],[306,11,1,13.417999839782714,18,18912,true],[324,11,5,8.193999862670898,8,11253,true],[318,11,6,10.245999908447265,18,19337,true],[333,11,0,10.894000053405762,14,7852,false],[309,11,4,12.91599998474121,18,5770,false],[323,11,4,8.003999996185303,14,7944,false],[322,11,3,7.688000106811524,14,7790,false],[334,11,1,5.7999999046325685,18,8125,false],[331,11,5,13.454000091552734,18,18595,true],[321,11,2,8.742000102996826,14,8351,false],[327,11,1,11.313999938964844,7,5567,false],[329,11,3,12.40399990081787,5,6923,false],[308,11,3,14.953999710083007,14,6141,false],[314,11,2,8.16200008392334,20,4773,false],[335,11,2,6.614000034332276,20,8553,false],[310,11,5,9.92199993133545,7,5927,false],[313,11,1,11.18799991607666,20,5145,false],[315,11,3,9.870000076293945,20,8395,false],[312,11,0,12.539999771118165,19,4943,false],[311,11,6,10.476000022888183,7,4681,false],[317,11,5,13.233999633789063,20,19600,true],[54,2,3,8.17799997329712,14,4160,false],[34,2,4,6.741999912261963,7,3727,false],[50,2,6,8.943999671936036,20,7447,true],[57,2,6,11.49199981689453,20,10766,true],[32,2,2,5.180000066757202,14,3277,false],[43,2,6,7.750000095367431,14,5716,true],[39,2,2,6.302499890327454,14,3202,false],[58,2,0,11.211999893188477,20,5707,true],[51,2,0,7.44399995803833,18,4251,false],[56,2,5,10.789999961853027,19,9036,true],[52,2,1,10.42199993133545,19,4520,false],[41,2,4,2.89399995803833,16,3180,false],[33,2,3,5.796666622161865,8,1774,false],[48,2,4,9.569999694824219,20,5045,false],[44,2,0,7.06200008392334,14,4201,false],[37,2,0,11.125,14,3310,false],[55,2,4,11.1060001373291,14,4613,false],[49,2,5,8.454000091552734,9,8529,true],[35,2,5,6.105999851226807,14,5064,false],[36,2,6,3.939999997615814,8,2568,false],[59,2,1,7.238000011444091,7,3489,false],[38,2,1,10.370000076293945,20,4289,false],[42,2,5,5.4679999351501465,14,6875,true],[46,2,2,9.72199993133545,20,5129,true],[40,2,3,5.8399999141693115,8,3267,false],[45,2,1,8.404000091552735,20,4916,false],[47,2,3,10.3560001373291,20,4973,false],[53,2,2,9.376000022888183,13,4426,false],[112,4,5,17.552000045776367,20,20158,true],[113,4,6,18.80399990081787,20,20331,true],[94,4,1,20.071999740600585,18,5525,false],[110,4,3,15.227999877929687,20,11401,true],[119,4,5,15.659999656677247,20,22741,true],[98,4,5,18.60200023651123,20,10722,false],[116,4,2,11.342000198364257,7,2550,false],[95,4,2,15.869999885559082,18,5678,false],[107,4,0,15.922000122070312,18,16601,true],[103,4,3,20.231999588012695,20,9886,false],[114,4,0,13.75800018310547,17,15903,true],[115,4,1,14.597999954223633,14,12653,true],[96,4,3,19.518000030517577,20,9998,false],[104,4,4,19.64600028991699,19,11031,true],[120,4,6,15.510000038146973,18,26668,true],[106,4,6,21.75199966430664,20,13362,true],[111,4,4,14.099999809265137,20,11905,true],[105,4,5,20.243999862670897,19,16062,true],[108,4,1,13.759999847412109,19,7073,false],[101,4,1,21.960000038146973,18,2527,false],[102,4,2,18.98400001525879,18,5837,false],[92,4,6,16.42400016784668,18,7475,false],[118,4,4,13.600000190734864,18,11667,true],[97,4,4,15.955999946594238,20,9346,false],[117,4,3,12.90999984741211,5,4964,false],[109,4,2,13.305999946594238,19,7417,false],[93,4,0,19.878000259399414,20,5190,false],[91,4,5,18.80799980163574,18,10076,false]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"doy","type":"\"long\"","metadata":"{}"},{"name":"month","type":"\"long\"","metadata":"{}"},{"name":"dow","type":"\"long\"","metadata":"{}"},{"name":"temperature","type":"\"double\"","metadata":"{}"},{"name":"desc","type":"\"long\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"},{"name":"label","type":"\"boolean\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291883256,"submitTime":1500291812866,"finishTime":1500291884764,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6877ac52-03a3-4a41-a100-8e6367ebe568"},{"version":"CommandV1","origId":3170457594604172,"guid":"d090db94-ce0b-4394-a92e-65bf44e6982b","subtype":"command","commandType":"auto","position":20.0,"command":"%sql DROP TABLE labeleddata","commandVersion":1,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1500291884771,"submitTime":1500291812878,"finishTime":1500291889159,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4f3f1285-25f1-4104-b376-6da72748174a"}],"dashboards":[],"guid":"89f63c62-a6df-484e-8043-a565e14e3f77","globalVars":{},"iPythonMetadata":{"nbformat":4,"IPythonMetadata":{"name":"new2","notebookId":412517841767719}},"inputWidgets":{}}