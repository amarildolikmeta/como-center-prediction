{"version":"NotebookV1","origId":2998738568508533,"name":"1-Data Cleaning","language":"python","commands":[{"version":"CommandV1","origId":760721092683981,"guid":"8b3961e6-2577-417b-8846-3ca5be66c36c","subtype":"command","commandType":"auto","position":10.75,"command":"max1","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">6</span><span class=\"ansired\">]: </span>&apos;2016-12-01 19:28:00+01&apos;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1500370357426,"submitTime":1500370212998,"finishTime":1500370357473,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"36339746-4d28-4af4-82c9-b5695610d552"},{"version":"CommandV1","origId":760721092683982,"guid":"0a044704-4962-4881-bbaf-80c3d3a3fc97","subtype":"command","commandType":"auto","position":25.5,"command":"best6=(-1,-1)\ncoef6={}\nfor i in xrange(8):\n  if i!=0 and i!=3 and i!=5:\n    data=join(rdds2[i],rdds2[5])\n    X=np.array(data.select('fw1').rdd.map(lambda x:x[0]).collect())\n    Y=np.array(data.select('fw2').rdd.map(lambda x:x[0]).collect())\n    coef=np.polyfit(X, Y, 1)\n    def f(x):\n      return coef[0]*x+coef[1]\n    F=np.vectorize(f)\n    mean=np.mean((F(X) - Y) ** 2)\n    if best6[0]<0 or best6[1]>mean:\n      best6=(i,mean)\n      coef6=coef\n    print(\"Mean Error \"+str(np.mean((f(X) - Y) ** 2))+\" for sensor \"+str(i+1))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Mean Error 165.323834703 for sensor 2\nMean Error 101.503658119 for sensor 3\nMean Error 114.261446482 for sensor 5\nMean Error 165.323834703 for sensor 7\nMean Error 113.538229418 for sensor 8\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"ConnectException: Connection refused (Connection refused)","error":null,"workflows":[],"startTime":1500371616260,"submitTime":1500370213118,"finishTime":1500371674888,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d3a6ae7a-19b1-4815-8579-263d4720560d"},{"version":"CommandV1","origId":1214224320307719,"guid":"cc0bbcfa-415c-4eae-b40e-b0de2833660d","subtype":"command","commandType":"auto","position":21.0,"command":"best1=(-1,-1)\ncoef1={}\nfor i in xrange(8):\n  if i!=0 and i!=3:\n    data=join(rdds1[i],rdds1[0])\n    X=np.array(data.select('fw1').rdd.map(lambda x:x[0]).collect())\n    Y=np.array(data.select('fw2').rdd.map(lambda x:x[0]).collect())\n    coef=np.polyfit(X, Y, 1)\n    def f(x):\n      return coef[0]*x+coef[1]\n    F=np.vectorize(f)\n    mean=np.mean((F(X) - Y) ** 2)\n    if best1[0]<0 or best1[1]>mean:\n      best1=(i,mean)\n      coef1=coef\n    print(\"Mean Error \"+str(np.mean((f(X) - Y) ** 2))+\" for sensor \"+str(i+1))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Mean Error 16.5496953461 for sensor 2\nMean Error 9.83312837846 for sensor 3\nMean Error 10.1716214807 for sensor 5\nMean Error 12.1495147131 for sensor 6\nMean Error 16.5496953461 for sensor 7\nMean Error 8.76738366116 for sensor 8\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371553606,"submitTime":1500370213094,"finishTime":1500371602044,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7b788344-4f58-4932-b8b6-093dfa1fc8bb"},{"version":"CommandV1","origId":1214224320307720,"guid":"6bbfbec6-bc01-4ecf-9aa1-bcd85628ff27","subtype":"command","commandType":"auto","position":22.0,"command":"from numpy import random\ndata=join(rdds1[best1[0]],rdds1[0])\nmatr=np.transpose(np.matrix([data.select('fw1').rdd.map(lambda x:x[0]).collect(), data.select('fw2').rdd.map(lambda x:x[0]).collect()]))\nidx = random.choice(len(matr),100000)\nsamples=matr[idx]\nnp.asarray(samples).tolist()\ndt=np.asarray(samples).tolist()\ndt=sorted(dt,key=lambda x:x[0])\ndf=sqlContext.createDataFrame(dt,schema=[\"s\"+str(best1[0]+1),\"s1\"])\ndisplay(df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,6],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,1],[0,0],[0,7],[0,0],[0,0],[0,0],[0,6],[0,1],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,1],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,2],[0,0],[0,2],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,5],[0,0],[0,0],[0,6],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,1],[0,1],[0,0],[0,0],[0,1],[0,4],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,5],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,5],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,6],[0,0],[0,4],[0,1],[0,0],[0,0],[0,0],[0,1],[0,1],[0,1],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,4],[0,1],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,7],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,5],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,4],[0,0],[0,2],[0,1],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,4],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,5],[0,0],[0,0],[0,0],[0,3],[0,2],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,5],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,6],[0,2],[0,4],[0,0],[0,1],[0,1],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,4],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,4],[0,1],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,3],[0,9],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,7],[0,0],[0,0],[0,0],[0,0],[0,1],[0,8],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,2],[0,6],[0,0],[0,5],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,1],[0,1],[0,0],[0,0],[0,4],[0,0],[0,0],[0,0],[0,7],[0,1],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,4],[0,0],[0,1],[0,2],[0,0],[0,1],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,5],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,4],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,9],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,1],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,4],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,7],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,4],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,1],[0,2],[0,0],[0,0],[0,3],[0,0],[0,0],[0,7],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,5],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,4],[0,2],[0,2],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,2],[0,2],[0,0],[0,0],[0,4],[0,0],[0,0],[0,0],[0,1],[0,0],[0,6],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,1],[0,0],[0,0],[0,0],[0,2],[0,1],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,2],[0,0],[0,0],[0,1],[0,0],[0,0],[0,2],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,4],[0,2],[0,0],[0,1],[0,0],[0,1],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,10],[0,0],[0,0],[0,0],[0,2],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"s8","type":"\"long\"","metadata":"{}"},{"name":"s1","type":"\"long\"","metadata":"{}"}],"overflow":true,"aggData":[[0,32],[1,34],[2,21],[3,25],[4,47],[5,44],[6,46],[7,32],[8,52],[9,21],[10,30],[11,37],[12,27],[13,23],[14,22],[15,21],[16,51],[17,23],[18,20],[19,20],[20,24],[21,16],[22,21],[23,13],[24,18],[25,17],[26,19],[27,13],[28,13],[29,16],[30,11],[31,5],[32,33],[33,7],[34,13],[35,27],[36,5],[37,5],[38,9],[39,9],[40,4],[41,1],[42,2],[43,3],[44,2],[45,8],[48,19],[49,17],[50,2],[54,6],[59,12]],"aggSchema":[{"name":"s8","type":"\"long\"","metadata":"{\"aggRole\":\"groupBy\"}"},{"name":"s1","type":"\"long\"","metadata":"{\"aggRole\":\"agg\"}"}],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"scalar","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;join&apos; is not defined","error":null,"workflows":[],"startTime":1500371602049,"submitTime":1500370213100,"finishTime":1500371616088,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"lineChart","width":"660","height":"auto","xColumns":["s8"],"yColumns":["s1"],"pivotColumns":[],"pivotAggregation":"max","customPlotOptions":{"lineChart":[],"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"db934c54-3d7b-4d9a-9229-5a89f326f977"},{"version":"CommandV1","origId":1214224320307721,"guid":"d3e57bfb-dc86-4cec-ad28-cbdc4445be98","subtype":"command","commandType":"auto","position":16.5,"command":"best4\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">20</span><span class=\"ansired\">]: </span>(7, 17.35571413435644)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371538509,"submitTime":1500370213081,"finishTime":1500371538584,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7098a2b8-1983-4200-b06c-7a1e63189361"},{"version":"CommandV1","origId":1214224320307723,"guid":"2bb03fe5-5f87-49da-b9ee-b9559913664d","subtype":"command","commandType":"auto","position":24.0,"command":"coef4","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">24</span><span class=\"ansired\">]: </span>array([ 0.43256871,  1.93843384])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371616102,"submitTime":1500370213106,"finishTime":1500371616178,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a4a389b2-1ac8-4dce-84cf-9738abaab9b8"},{"version":"CommandV1","origId":1214224320307724,"guid":"e4b177c7-13fc-4aa5-951e-f3c876eedc6e","subtype":"command","commandType":"auto","position":25.0,"command":"coef1","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">25</span><span class=\"ansired\">]: </span>array([ 0.32662604,  1.31837123])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371616185,"submitTime":1500370213112,"finishTime":1500371616253,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e94f26c9-35d6-448e-be63-cc96c25ab401"},{"version":"CommandV1","origId":1214224320307725,"guid":"47e5094a-7167-4697-8b79-d7ca390d1df4","subtype":"command","commandType":"auto","position":26.0,"command":"post4=sqlContext.sql(str(\"Select * from sensorsdata5 where elementid=\"+str(best4[0]+1)+\" and to>'\")+max4+\"'\")\npost4RDD=post4.rdd.map(lambda x:(x[0],x[1],x[2],x[3],x[4],x[5]))\npost1=sqlContext.sql(str(\"Select * from sensorsdata5 where elementid=\"+str(best1[0]+1)+\" and to>'\")+max1+\"'\")\npost1RDD=post1.rdd.map(lambda x:(x[0],x[1],x[2],x[3],x[4],x[5]))\npost6=sqlContext.sql(str(\"Select * from sensorsdata5 where elementid=\"+str(best6[0]+1)+\" and to>'\")+max6+\"'\")\npost6RDD=post6.rdd.map(lambda x:(x[0],x[1],x[2],x[3],x[4],x[5]))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371674893,"submitTime":1500370213124,"finishTime":1500371675339,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d37a55fc-7f87-4939-acff-23440b8f4a95"},{"version":"CommandV1","origId":1214224320307726,"guid":"df55204f-edf2-4080-acd5-ed7e77dc9f51","subtype":"command","commandType":"auto","position":27.0,"command":"def reggr1(x):\n  return coef1[0]*x+coef1[1]\ndef reggr4(x):\n  return coef4[0]*x+coef4[1]\ndef reggr6(x):\n  return coef6[0]*x+coef6[1]\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371675846,"submitTime":1500370213137,"finishTime":1500371675899,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"75c4a76f-a08d-4aa5-89b0-faa21625621e"},{"version":"CommandV1","origId":1214224320307727,"guid":"e0371782-b199-430f-8be6-e1d7960fdc7e","subtype":"command","commandType":"auto","position":28.0,"command":"post1RDD=post1RDD.map(lambda x:(x[0],x[1],int(reggr1(x[2])),x[3],x[4],1))\npost4RDD=post4RDD.map(lambda x:(x[0],x[1],int(reggr4(x[2])),x[3],x[4],4))\npost6RDD=post6RDD.map(lambda x:(x[0],x[1],int(reggr6(x[2])),x[3],x[4],6))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371675907,"submitTime":1500370213143,"finishTime":1500371675981,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4da89f97-1706-4cc6-acde-569fd9d4b0a6"},{"version":"CommandV1","origId":1214224320307728,"guid":"d8452c93-aa57-4c77-beaf-079213d7b5b6","subtype":"command","commandType":"auto","position":26.5,"command":"post4RDD.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">28</span><span class=\"ansired\">]: </span>\n[(u&apos;2016-10-10 16:45:00+02&apos;, u&apos;2016-10-10 16:46:00+02&apos;, 0, 5, 815935, 8),\n (u&apos;2016-10-10 18:23:00+02&apos;, u&apos;2016-10-10 18:24:00+02&apos;, 2, 2, 816428, 8),\n (u&apos;2016-10-10 19:41:00+02&apos;, u&apos;2016-10-10 19:42:00+02&apos;, 7, 1, 816819, 8),\n (u&apos;2016-10-10 22:34:00+02&apos;, u&apos;2016-10-10 22:35:00+02&apos;, 0, 2, 817685, 8),\n (u&apos;2016-10-11 05:03:00+02&apos;, u&apos;2016-10-11 05:04:00+02&apos;, 0, 0, 819627, 8),\n (u&apos;2016-10-11 09:06:00+02&apos;, u&apos;2016-10-11 09:07:00+02&apos;, 1, 0, 820842, 8),\n (u&apos;2016-10-11 10:14:00+02&apos;, u&apos;2016-10-11 10:15:00+02&apos;, 5, 5, 821183, 8),\n (u&apos;2016-10-11 11:05:00+02&apos;, u&apos;2016-10-11 11:06:00+02&apos;, 4, 3, 821437, 8),\n (u&apos;2016-10-11 11:07:00+02&apos;, u&apos;2016-10-11 11:08:00+02&apos;, 6, 2, 821447, 8),\n (u&apos;2016-10-11 12:55:00+02&apos;, u&apos;2016-10-11 12:56:00+02&apos;, 6, 9, 821905, 8)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371675345,"submitTime":1500370213131,"finishTime":1500371675834,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3b1af2a1-3ed3-4248-bfce-538569647428"},{"version":"CommandV1","origId":1214224320307729,"guid":"09015f6a-da43-41ee-8d96-13b5362a1312","subtype":"command","commandType":"auto","position":29.0,"command":"post1RDD.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">31</span><span class=\"ansired\">]: </span>\n[(u&apos;2016-12-01 20:47:00+01&apos;, u&apos;2016-12-01 20:48:00+01&apos;, 2, 5, 1252657, 1),\n (u&apos;2016-12-01 21:06:00+01&apos;, u&apos;2016-12-01 21:07:00+01&apos;, 4, 4, 1252734, 1),\n (u&apos;2016-12-02 06:22:00+01&apos;, u&apos;2016-12-02 06:23:00+01&apos;, 3, 5, 1255590, 1),\n (u&apos;2016-12-02 14:00:00+01&apos;, u&apos;2016-12-02 14:01:00+01&apos;, 1, 1, 1290847, 1),\n (u&apos;2016-12-02 22:30:00+01&apos;, u&apos;2016-12-02 22:31:00+01&apos;, 4, 5, 1324986, 1),\n (u&apos;2016-12-02 23:20:00+01&apos;, u&apos;2016-12-02 23:21:00+01&apos;, 3, 10, 1325262, 1),\n (u&apos;2016-12-03 01:52:00+01&apos;, u&apos;2016-12-03 01:53:00+01&apos;, 3, 4, 1326050, 1),\n (u&apos;2016-12-03 03:57:00+01&apos;, u&apos;2016-12-03 03:58:00+01&apos;, 3, 3, 1326676, 1),\n (u&apos;2016-12-03 05:58:00+01&apos;, u&apos;2016-12-03 05:59:00+01&apos;, 4, 2, 1327280, 1),\n (u&apos;2016-12-03 08:33:00+01&apos;, u&apos;2016-12-03 08:34:00+01&apos;, 2, 1, 1328055, 1)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371675986,"submitTime":1500370213149,"finishTime":1500371676434,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0a80a3dd-83ad-437a-aa23-97ef5a5d8e56"},{"version":"CommandV1","origId":1214224320307730,"guid":"551a7b86-8727-45a8-b7fd-7c6c38a22abc","subtype":"command","commandType":"auto","position":30.0,"command":"fullSet=sqlContext.sql(\"Select * from sensorsdata5\").rdd.map(lambda x:(x[0],x[1],x[2],x[3],x[4],x[5]))\nInterpolatedData=sc.union([fullSet,post1RDD,post4RDD,post6RDD])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371676445,"submitTime":1500370213156,"finishTime":1500371676623,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5e03d906-cfde-481f-b51a-e42ac823d0b0"},{"version":"CommandV1","origId":1214224320307731,"guid":"7dcae2cb-9b2d-42a8-a3a8-5d4fe0a2f577","subtype":"command","commandType":"auto","position":31.0,"command":"InterpolatedData.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">33</span><span class=\"ansired\">]: </span>3152329\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371676647,"submitTime":1500370213163,"finishTime":1500371724254,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b6623542-0fde-4981-a885-a772aad44ceb"},{"version":"CommandV1","origId":1214224320307732,"guid":"c458c899-7235-473b-b25f-05d7b0293536","subtype":"command","commandType":"auto","position":32.0,"command":"InterpolatedDF=sqlContext.createDataFrame(InterpolatedData, schema=['from', 'to', 'fw','bw','id','elementid'])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371724258,"submitTime":1500370213169,"finishTime":1500371724787,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8416ecf1-7c3a-448e-806a-093ee66ad500"},{"version":"CommandV1","origId":1214224320307734,"guid":"874174b6-c591-4118-9d94-4d6ea7e300c4","subtype":"command","commandType":"auto","position":34.0,"command":"InterpolatedDF.write.saveAsTable('sensordata')","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;Table &#96;sensordata&#96; already exists.;&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-36-74ad556ee472&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>InterpolatedDF<span class=\"ansiyellow\">.</span>write<span class=\"ansiyellow\">.</span>saveAsTable<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;sensordata&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/readwriter.py</span> in <span class=\"ansicyan\">saveAsTable</span><span class=\"ansiblue\">(self, name, format, mode, partitionBy, **options)</span>\n<span class=\"ansigreen\">    586</span>         <span class=\"ansigreen\">if</span> format <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    587</span>             self<span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>format<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 588</span><span class=\"ansiyellow\">         </span>self<span class=\"ansiyellow\">.</span>_jwrite<span class=\"ansiyellow\">.</span>saveAsTable<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    589</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    590</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.4</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&apos;Table &#96;sensordata&#96; already exists.;&apos;</div>","workflows":[],"startTime":1500370213182,"submitTime":1500370213182,"finishTime":1500371727041,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c4c3efad-ee51-4e24-9e67-65f1b05b1ddb"},{"version":"CommandV1","origId":1214224320307738,"guid":"dbffba29-6a60-4e7b-ba2c-0de158b2230b","subtype":"command","commandType":"auto","position":36.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d9617d99-8d3e-442a-8f50-c4b3aaf18061"},{"version":"CommandV1","origId":1456266427964815,"guid":"91693f7e-e3d1-436e-b9d0-ceb32a869553","subtype":"command","commandType":"auto","position":11.0,"command":"correlation4=sqlContext.sql(str(\"Select * from sensorsdata5 where to<='\")+max4+\"'\")\ncorrelation1=sqlContext.sql(str(\"Select * from sensorsdata5 where to<='\")+max1+\"'\")\ncorrelation6=sqlContext.sql(str(\"Select * from sensorsdata5 where to<='\")+max6+\"'\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500370357488,"submitTime":1500370213004,"finishTime":1500370357818,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c75f1bd4-b263-48cb-b1c7-3808ee0a29ef"},{"version":"CommandV1","origId":1456266427964816,"guid":"7859e20b-87b2-415e-8581-8b0ddde393c6","subtype":"command","commandType":"auto","position":10.5,"command":"max4=str(until.rdd.map(lambda x:x[1]).take(3)[2])\nmax6=str(until.rdd.map(lambda x:x[1]).take(2)[1])\nmax1=str(until.rdd.map(lambda x:x[1]).take(2)[0])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">IndexError</span>: list index out of range","error":null,"workflows":[],"startTime":1500370338845,"submitTime":1500370212992,"finishTime":1500370357412,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"49639771-fc56-4b35-b213-4ef36238a014"},{"version":"CommandV1","origId":1456266427964817,"guid":"243e686a-f788-450c-b093-76a6dbbc04a9","subtype":"command","commandType":"auto","position":12.0,"command":"correlation4.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+--------------------+---+---+------+---------+\n|                from|                  to| fw| bw|    id|elementid|\n+--------------------+--------------------+---+---+------+---------+\n|2016-07-01 17:00:...|2016-07-01 18:00:...|213|145|889707|        2|\n|2016-07-02 08:00:...|2016-07-02 09:00:...|269|200|889960|        6|\n|2016-07-21 11:35:...|2016-07-21 11:36:...| 14| 10|   997|        3|\n|2016-07-21 11:51:...|2016-07-21 11:52:...|  2|  1|  1107|        2|\n|2016-07-21 11:59:...|2016-07-21 12:00:...|  0|  0|  1166|        7|\n|2016-07-21 12:02:...|2016-07-21 12:03:...|  3|  5|  1185|        3|\n|2016-07-21 12:48:...|2016-07-21 12:49:...|  9|  7|  1508|        4|\n|2016-07-21 13:39:...|2016-07-21 13:40:...|  4|  3|  1861|        5|\n|2016-07-21 14:06:...|2016-07-21 14:07:...|  7|  1|  2051|        4|\n|2016-07-21 14:15:...|2016-07-21 14:16:...|  3|  4|  2111|        5|\n|2016-07-21 14:20:...|2016-07-21 14:21:...|  0|  0|  2151|        7|\n|2016-07-21 14:27:...|2016-07-21 14:28:...|  1|  5|  2198|        5|\n|2016-07-21 15:28:...|2016-07-21 15:29:...|  2|  9|  2622|        5|\n|2016-07-21 17:18:...|2016-07-21 17:19:...|  1|  3|  3394|        1|\n|2016-07-21 17:31:...|2016-07-21 17:32:...|  9|  2|  3479|        5|\n|2016-07-21 17:31:...|2016-07-21 17:32:...|  0|  8|  3482|        6|\n|2016-07-21 17:47:...|2016-07-21 17:48:...|  5|  3|  3593|        4|\n|2016-07-21 18:07:...|2016-07-21 18:08:...|  6|  2|  3732|        6|\n|2016-07-21 18:28:...|2016-07-21 18:29:...|  2| 12|  3881|        5|\n|2016-07-21 19:03:...|2016-07-21 19:04:...|  5|  1|  4129|        1|\n+--------------------+--------------------+---+---+------+---------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500370357828,"submitTime":1500370213009,"finishTime":1500370358512,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b77023b6-d319-4639-9b86-d90226e241ba"},{"version":"CommandV1","origId":1456266427964819,"guid":"b444a5a0-e0a2-4f7f-a7dd-1d68cf4e31c4","subtype":"command","commandType":"auto","position":12.5,"command":"correlationRDD=correlation4.rdd.map(lambda x:(x[0],x[1],int(x[2]),int(x[3]),int(x[4]),int(x[5])))\ncorrelationRDD2=correlation1.rdd.map(lambda x:(x[0],x[1],int(x[2]),int(x[3]),int(x[4]),int(x[5])))\ncorrelationRDD3=correlation6.rdd.map(lambda x:(x[0],x[1],int(x[2]),int(x[3]),int(x[4]),int(x[5])))\ncorrelationRDD.take(5)\nrdds=[i for i in xrange(8)]\nrdds1=[i for i in xrange(8)]\nrdds2=[i for i in xrange(8)]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;correlation4&apos; is not defined","error":null,"workflows":[],"startTime":1500370358524,"submitTime":1500370213015,"finishTime":1500370359471,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cd5ec56f-fec0-43e1-b879-b436db02049a"},{"version":"CommandV1","origId":1456266427964823,"guid":"b1d03d03-f77a-444a-aa68-2b45d04b6f2f","subtype":"command","commandType":"auto","position":13.25,"command":"four=correlationRDD.filter(lambda x:x[5]==4)\nfour=four.sortBy(lambda x: x[2],ascending=True)\nrdds[3]=four\nfour.take(5)\nfour=correlationRDD2.filter(lambda x:x[5]==4)\nfour=four.sortBy(lambda x: x[2],ascending=True)\nrdds1[3]=four\nfour.take(5)\nfour=correlationRDD3.filter(lambda x:x[5]==4)\nfour=four.sortBy(lambda x: x[2],ascending=True)\nrdds2[3]=four\nfour.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">10</span><span class=\"ansired\">]: </span>\n[(u&apos;2016-07-22 00:15:00+02&apos;, u&apos;2016-07-22 00:16:00+02&apos;, 0, 0, 6305, 4),\n (u&apos;2016-07-22 06:49:00+02&apos;, u&apos;2016-07-22 06:50:00+02&apos;, 0, 0, 9065, 4),\n (u&apos;2016-07-23 02:49:00+02&apos;, u&apos;2016-07-23 02:50:00+02&apos;, 0, 0, 17340, 4),\n (u&apos;2016-07-23 03:29:00+02&apos;, u&apos;2016-07-23 03:30:00+02&apos;, 0, 0, 17619, 4),\n (u&apos;2016-07-24 04:14:00+02&apos;, u&apos;2016-07-24 04:15:00+02&apos;, 0, 0, 27930, 4)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500370359487,"submitTime":1500370213021,"finishTime":1500370511167,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1cb79ab5-07e1-4dda-8e86-9c7f926a4e5b"},{"version":"CommandV1","origId":1456266427964826,"guid":"900b43e0-bfb6-4d7e-86d8-9db2a8196650","subtype":"command","commandType":"auto","position":13.4375,"command":"def join(rdd1,rdd2):\n  df1 = sqlContext.createDataFrame(rdd1, schema=['from', 'to', 'fw1','bw1','id','elementid'])\n  df2 = sqlContext.createDataFrame(rdd2, schema=['from', 'to', 'fw2','bw2','id','elementid'])\n  rdd_join = df1.join(df2, on=['from'])\n  return rdd_join\n  ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371482082,"submitTime":1500370213068,"finishTime":1500371482160,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b5482f29-b282-450f-bc55-303488c27c11"},{"version":"CommandV1","origId":1456266427964828,"guid":"54e7eaa5-a3a7-40fe-8035-5f1cee8211a0","subtype":"command","commandType":"auto","position":13.34375,"command":"one=correlationRDD.filter(lambda x:x[5]==1)\none=one.sortBy(lambda x: x[2],ascending=True)\nrdds[0]=one\none.take(5)\none=correlationRDD2.filter(lambda x:x[5]==1)\none=one.sortBy(lambda x: x[2],ascending=True)\nrdds1[0]=one\none.take(5)\none=correlationRDD3.filter(lambda x:x[5]==1)\none=one.sortBy(lambda x: x[2],ascending=True)\nrdds2[0]=one\none.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">12</span><span class=\"ansired\">]: </span>\n[(u&apos;2016-07-21 21:39:00+02&apos;, u&apos;2016-07-21 21:40:00+02&apos;, 0, 0, 5218, 1),\n (u&apos;2016-07-22 20:46:00+02&apos;, u&apos;2016-07-22 20:47:00+02&apos;, 0, 3, 14891, 1),\n (u&apos;2016-07-22 21:13:00+02&apos;, u&apos;2016-07-22 21:14:00+02&apos;, 0, 3, 15048, 1),\n (u&apos;2016-07-23 09:52:00+02&apos;, u&apos;2016-07-23 09:53:00+02&apos;, 0, 0, 20304, 1),\n (u&apos;2016-07-24 03:15:00+02&apos;, u&apos;2016-07-24 03:16:00+02&apos;, 0, 1, 27578, 1)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500370685025,"submitTime":1500370213032,"finishTime":1500370855910,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ea394ef2-9d83-4414-9b81-5e567a9b0dcf"},{"version":"CommandV1","origId":1456266427964829,"guid":"2774fe08-b21f-4f0c-bd55-c57b637c13a7","subtype":"command","commandType":"auto","position":13.390625,"command":"eight=correlationRDD.filter(lambda x:x[5]==8)\neight=eight.sortBy(lambda x: x[2],ascending=True)\nrdds[7]=eight\neight.take(5)\neight=correlationRDD2.filter(lambda x:x[5]==8)\neight=eight.sortBy(lambda x: x[2],ascending=True)\nrdds1[7]=eight\neight.take(5)\neight=correlationRDD3.filter(lambda x:x[5]==8)\neight=eight.sortBy(lambda x: x[2],ascending=True)\nrdds2[7]=eight\neight.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">13</span><span class=\"ansired\">]: </span>\n[(u&apos;2016-07-30 01:09:00+02&apos;, u&apos;2016-07-30 01:10:00+02&apos;, 0, 0, 84669, 8),\n (u&apos;2016-07-31 06:28:00+02&apos;, u&apos;2016-07-31 06:29:00+02&apos;, 0, 0, 97851, 8),\n (u&apos;2016-07-31 23:35:00+02&apos;, u&apos;2016-07-31 23:36:00+02&apos;, 0, 2, 105022, 8),\n (u&apos;2016-08-01 02:29:00+02&apos;, u&apos;2016-08-01 02:30:00+02&apos;, 0, 0, 108791, 8),\n (u&apos;2016-08-01 21:59:00+02&apos;, u&apos;2016-08-01 22:00:00+02&apos;, 0, 0, 117205, 8)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500370855915,"submitTime":1500370213039,"finishTime":1500370983658,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4cf92c4e-4477-49a6-b2d7-88b4e947c5bc"},{"version":"CommandV1","origId":1456266427964833,"guid":"c595f9b8-ed30-4793-882e-0b2a31400f6a","subtype":"command","commandType":"auto","position":16.0,"command":"import numpy as np\nbest4=(-1,-1)\ncoef4={}\nfor i in xrange(8):\n  if i!=3:\n    data=join(rdds[i],rdds[3])\n    X=np.array(data.select('fw1').rdd.map(lambda x:x[0]).collect())\n    Y=np.array(data.select('fw2').rdd.map(lambda x:x[0]).collect())\n    coef=np.polyfit(X, Y, 1)\n    def f(x):\n      return coef[0]*x+coef[1]\n    F=np.vectorize(f)\n    mean=np.mean((F(X) - Y) ** 2)\n    if best4[0]<0 or best4[1]>mean:\n      best4=(i,mean)\n      coef4=coef\n    print(\"Mean Error \"+str(mean)+\" for sensor \"+str(i+1))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Mean Error 70.2336671814 for sensor 1\nMean Error 92.3565422774 for sensor 2\nMean Error 53.8612136434 for sensor 3\nMean Error 18.5187384418 for sensor 5\nMean Error 49.1072323437 for sensor 6\nMean Error 92.3565422774 for sensor 7\nMean Error 17.3557141344 for sensor 8\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371482165,"submitTime":1500370213074,"finishTime":1500371538502,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fe2ccd7f-00ec-40c4-9a8b-797077667951"},{"version":"CommandV1","origId":1456266427964836,"guid":"7974357f-7dbc-4922-97c9-ab549bd33d32","subtype":"command","commandType":"auto","position":17.0,"command":"from numpy import random\ndata=join(rdds[best4[0]],rdds[3])\nmatr=np.transpose(np.matrix([data.select('fw1').rdd.map(lambda x:x[0]).collect(), data.select('fw2').rdd.map(lambda x:x[0]).collect()]))\nidx = random.choice(len(matr),100000)\nsamples=matr[idx]\nnp.asarray(samples).tolist()\ndt=np.asarray(samples).tolist()\ndt=sorted(dt,key=lambda x:x[0])\ndf=sqlContext.createDataFrame(dt,schema=[\"s\"+str(best4[0]+1),\"s4\"])\ndisplay(df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,10],[0,4],[0,1],[0,0],[0,0],[0,0],[0,2],[0,2],[0,0],[0,1],[0,0],[0,0],[0,2],[0,2],[0,1],[0,5],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,1],[0,2],[0,2],[0,0],[0,0],[0,0],[0,1],[0,0],[0,4],[0,0],[0,0],[0,3],[0,0],[0,0],[0,2],[0,0],[0,0],[0,2],[0,0],[0,0],[0,1],[0,0],[0,2],[0,0],[0,0],[0,0],[0,2],[0,1],[0,3],[0,1],[0,1],[0,1],[0,0],[0,0],[0,1],[0,1],[0,0],[0,0],[0,2],[0,1],[0,1],[0,0],[0,1],[0,0],[0,0],[0,0],[0,1],[0,0],[0,1],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,3],[0,3],[0,0],[0,3],[0,2],[0,1],[0,2],[0,0],[0,1],[0,0],[0,1],[0,0],[0,0],[0,2],[0,1],[0,0],[0,0],[0,2],[0,0],[0,0],[0,1],[0,1],[0,2],[0,2],[0,1],[0,2],[0,0],[0,0],[0,1],[0,3],[0,7],[0,5],[0,2],[0,1],[0,0],[0,1],[0,2],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,1],[0,1],[0,0],[0,3],[0,5],[0,0],[0,0],[0,0],[0,1],[0,0],[0,1],[0,0],[0,2],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,1],[0,1],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,4],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,2],[0,0],[0,1],[0,3],[0,1],[0,2],[0,1],[0,1],[0,0],[0,0],[0,0],[0,1],[0,0],[0,1],[0,1],[0,0],[0,3],[0,0],[0,4],[0,0],[0,2],[0,3],[0,4],[0,1],[0,2],[0,4],[0,1],[0,0],[0,1],[0,1],[0,15],[0,9],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,1],[0,1],[0,0],[0,2],[0,0],[0,4],[0,0],[0,0],[0,0],[0,0],[0,1],[0,1],[0,0],[0,10],[0,1],[0,0],[0,0],[0,7],[0,2],[0,1],[0,0],[0,0],[0,5],[0,0],[0,0],[0,0],[0,1],[0,1],[0,0],[0,2],[0,1],[0,1],[0,1],[0,0],[0,0],[0,0],[0,1],[0,2],[0,5],[0,1],[0,2],[0,0],[0,3],[0,2],[0,1],[0,0],[0,1],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,3],[0,5],[0,0],[0,1],[0,0],[0,1],[0,7],[0,0],[0,1],[0,3],[0,0],[0,7],[0,0],[0,0],[0,1],[0,0],[0,0],[0,1],[0,7],[0,1],[0,0],[0,1],[0,1],[0,0],[0,1],[0,1],[0,3],[0,1],[0,0],[0,3],[0,0],[0,1],[0,3],[0,2],[0,0],[0,1],[0,1],[0,0],[0,1],[0,1],[0,1],[0,0],[0,0],[0,0],[0,1],[0,0],[0,1],[0,0],[0,1],[0,1],[0,0],[0,5],[0,2],[0,3],[0,0],[0,5],[0,0],[0,2],[0,0],[0,1],[0,1],[0,0],[0,0],[0,1],[0,0],[0,2],[0,0],[0,0],[0,6],[0,1],[0,1],[0,0],[0,3],[0,0],[0,0],[0,1],[0,0],[0,0],[0,1],[0,2],[0,1],[0,0],[0,3],[0,0],[0,2],[0,1],[0,3],[0,0],[0,0],[0,0],[0,1],[0,0],[0,1],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,1],[0,0],[0,3],[0,3],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,1],[0,0],[0,0],[0,0],[0,1],[0,1],[0,0],[0,2],[0,2],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,3],[0,2],[0,0],[0,3],[0,0],[0,0],[0,1],[0,0],[0,0],[0,1],[0,2],[0,1],[0,0],[0,1],[0,0],[0,1],[0,1],[0,2],[0,0],[0,0],[0,1],[0,0],[0,1],[0,0],[0,0],[0,0],[0,1],[0,0],[0,1],[0,1],[0,0],[0,0],[0,4],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,2],[0,0],[0,0],[0,2],[0,0],[0,1],[0,1],[0,0],[0,0],[0,1],[0,3],[0,0],[0,1],[0,1],[0,0],[0,1],[0,1],[0,1],[0,2],[0,0],[0,0],[0,0],[0,1],[0,1],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,6],[0,0],[0,1],[0,1],[0,7],[0,0],[0,0],[0,1],[0,1],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,3],[0,0],[0,2],[0,3],[0,0],[0,7],[0,0],[0,0],[0,1],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,9],[0,2],[0,1],[0,0],[0,0],[0,0],[0,0],[0,4],[0,0],[0,1],[0,1],[0,0],[0,1],[0,0],[0,0],[0,0],[0,1],[0,1],[0,1],[0,3],[0,0],[0,0],[0,2],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,2],[0,1],[0,1],[0,0],[0,5],[0,3],[0,2],[0,0],[0,0],[0,0],[0,0],[0,8],[0,0],[0,0],[0,0],[0,0],[0,7],[0,1],[0,1],[0,0],[0,1],[0,1],[0,0],[0,0],[0,0],[0,0],[0,2],[0,2],[0,0],[0,1],[0,0],[0,2],[0,0],[0,0],[0,3],[0,0],[0,2],[0,0],[0,3],[0,1],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,9],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,1],[0,1],[0,1],[0,0],[0,0],[0,0],[0,0],[0,1],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,1],[0,0],[0,1],[0,0],[0,0],[0,1],[0,1],[0,0],[0,0],[0,0],[0,0],[0,1],[0,1],[0,12],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,8],[0,6],[0,0],[0,0],[0,11],[0,1],[0,1],[0,0],[0,1],[0,2],[0,1],[0,2],[0,0],[0,0],[0,4],[0,1],[0,1],[0,0],[0,0],[0,2],[0,0],[0,0],[0,1],[0,0],[0,1],[0,1],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,0],[0,13],[0,0],[0,1],[0,0],[0,5],[0,1],[0,0],[0,15],[0,1],[0,2],[0,1],[0,0],[0,1],[0,0],[0,1],[0,3],[0,0],[0,0],[0,0],[0,0],[0,3],[0,1],[0,3],[0,8],[0,1],[0,0],[0,0],[0,2],[0,0],[0,1],[0,1],[0,1],[0,0],[0,0],[0,4],[0,0],[0,0],[0,2],[0,8],[0,0],[0,3],[0,0],[0,0],[0,0],[0,2],[0,0],[0,2],[0,1],[0,0],[0,1],[0,1],[0,0],[0,1],[0,0],[0,0],[0,0],[0,21],[0,0],[0,0],[0,1],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,5],[0,3],[0,2],[0,1],[0,2],[0,1],[0,0],[0,2],[0,2],[0,0],[0,1],[0,0],[0,0],[0,1],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,4],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,2],[0,1],[0,2],[0,0],[0,0],[0,2],[0,6],[0,0],[0,8],[0,0],[0,0],[0,1],[0,1],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,1],[0,0],[0,0],[0,2],[0,0],[0,1],[0,0],[0,0],[0,0],[0,3],[0,0],[0,7],[0,0],[0,0],[0,1],[0,3],[0,5],[0,2],[0,0],[0,0],[0,1],[0,0],[0,3],[0,2],[0,1],[0,0],[0,1],[0,0],[0,1],[0,1],[0,0],[0,0],[0,2],[0,0],[0,1],[0,0],[0,2],[0,1],[0,0],[0,2],[0,4],[0,1],[0,0],[0,0],[0,0],[0,10],[0,1],[0,3],[0,6],[0,1],[0,0],[0,0],[0,0],[0,0],[0,2],[0,1],[0,2],[0,0],[0,0],[0,2],[0,1],[0,0],[0,0],[0,2],[0,1],[0,0],[0,1],[0,1],[0,0],[0,4],[0,0],[0,2],[0,0],[0,0],[0,5],[0,0],[0,0],[0,1],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,1],[0,2],[0,0],[0,0],[0,0],[0,2],[0,2],[0,0],[0,2],[0,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0],[0,2],[0,1],[0,1],[0,3],[0,0],[0,5],[0,0],[0,3],[0,2],[0,0],[0,0],[0,0],[0,1],[0,3],[0,0],[0,1],[0,7],[0,4],[0,0],[0,0],[0,0],[0,3],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,1],[0,1],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,7],[0,1],[0,1],[0,3],[0,1],[0,1],[0,0],[0,3],[0,1],[0,1],[0,3],[0,1],[0,0],[0,4],[0,0],[0,0],[0,0],[0,2],[0,0],[0,0],[0,7],[0,1],[0,1],[0,8],[0,0],[0,0],[0,0],[0,1],[0,0],[0,0],[0,0],[0,1],[0,2],[0,2],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,2],[0,0],[0,1],[0,0],[0,0],[0,0],[0,0],[0,1],[0,4],[0,5],[0,0],[0,1],[0,0],[0,5],[0,0],[0,1],[0,0],[0,3],[0,0],[0,0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"s8","type":"\"long\"","metadata":"{}"},{"name":"s4","type":"\"long\"","metadata":"{}"}],"overflow":true,"aggData":[[0,43513],[1,18994],[2,27727],[3,29451],[4,29783],[5,29108],[6,27695],[7,25267],[8,22638],[9,19604],[10,16122],[11,13019],[12,11784],[13,9762],[14,7093],[15,5512],[16,4813],[17,3839],[18,2645],[19,1980],[20,1663],[21,1113],[22,851],[23,727],[24,331],[25,423],[26,127],[27,248],[28,284],[29,112],[30,74],[31,45],[32,142],[33,52],[34,191],[35,10],[36,54],[37,104],[38,3],[39,21],[40,38],[41,51],[42,2],[44,4],[45,24],[46,22],[48,74],[50,23],[53,67],[54,19],[59,159],[68,1],[73,37]],"aggSchema":[{"name":"s8","type":"\"long\"","metadata":"{\"aggRole\":\"groupBy\"}"},{"name":"s4","type":"\"long\"","metadata":"{\"aggRole\":\"agg\"}"}],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"scalar","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;join&apos; is not defined","error":null,"workflows":[],"startTime":1500371538601,"submitTime":1500370213088,"finishTime":1500371553565,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"lineChart","width":"660","height":"auto","xColumns":["s8"],"yColumns":["s4"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"lineChart":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"629e564d-f86f-4a74-8b18-f01f3aef5dd5"},{"version":"CommandV1","origId":1456266427964837,"guid":"5112314f-63aa-4883-907b-64fd4ff8a57c","subtype":"command","commandType":"auto","position":13.296875,"command":"two=correlationRDD.filter(lambda x:x[5]==2)\ntwo=two.sortBy(lambda x: x[2],ascending=True)\nrdds[1]=two\ntwo.take(5)\ntwo=correlationRDD2.filter(lambda x:x[5]==2)\ntwo=two.sortBy(lambda x: x[2],ascending=True)\nrdds1[1]=two\ntwo.take(5)\ntwo=correlationRDD3.filter(lambda x:x[5]==2)\ntwo=two.sortBy(lambda x: x[2],ascending=True)\nrdds2[1]=two\ntwo.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">11</span><span class=\"ansired\">]: </span>\n[(u&apos;2016-07-21 19:32:00+02&apos;, u&apos;2016-07-21 19:33:00+02&apos;, 0, 0, 4329, 2),\n (u&apos;2016-07-21 20:27:00+02&apos;, u&apos;2016-07-21 20:28:00+02&apos;, 0, 0, 4709, 2),\n (u&apos;2016-07-22 04:43:00+02&apos;, u&apos;2016-07-22 04:44:00+02&apos;, 0, 0, 8184, 2),\n (u&apos;2016-07-22 04:49:00+02&apos;, u&apos;2016-07-22 04:50:00+02&apos;, 0, 0, 8223, 2),\n (u&apos;2016-07-22 15:42:00+02&apos;, u&apos;2016-07-22 15:43:00+02&apos;, 0, 0, 12752, 2)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500370511178,"submitTime":1500370213026,"finishTime":1500370685017,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a5c7c7b4-be17-4ad6-9bdf-49534edbe89f"},{"version":"CommandV1","origId":1456266427964838,"guid":"fd487321-241b-4656-9c1e-d90ddf0aa893","subtype":"command","commandType":"auto","position":13.4140625,"command":"three=correlationRDD.filter(lambda x:x[5]==3)\nthree=three.sortBy(lambda x: x[2],ascending=True)\nrdds[2]=three\nthree.take(5)\nthree=correlationRDD2.filter(lambda x:x[5]==3)\nthree=three.sortBy(lambda x: x[2],ascending=True)\nrdds1[2]=three\nthree.take(5)\nthree=correlationRDD3.filter(lambda x:x[5]==3)\nthree=three.sortBy(lambda x: x[2],ascending=True)\nrdds2[2]=three\nthree.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">14</span><span class=\"ansired\">]: </span>\n[(u&apos;2016-07-22 01:14:00+02&apos;, u&apos;2016-07-22 01:15:00+02&apos;, 0, 0, 6722, 3),\n (u&apos;2016-07-22 03:38:00+02&apos;, u&apos;2016-07-22 03:39:00+02&apos;, 0, 0, 7731, 3),\n (u&apos;2016-07-22 03:44:00+02&apos;, u&apos;2016-07-22 03:45:00+02&apos;, 0, 0, 7768, 3),\n (u&apos;2016-07-23 02:40:00+02&apos;, u&apos;2016-07-23 02:41:00+02&apos;, 0, 0, 17277, 3),\n (u&apos;2016-07-23 02:52:00+02&apos;, u&apos;2016-07-23 02:53:00+02&apos;, 0, 0, 17358, 3)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500370983664,"submitTime":1500370213045,"finishTime":1500371106975,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"dc0a3564-fe6d-4a99-8dc5-f6f578e1e093"},{"version":"CommandV1","origId":1456266427964839,"guid":"985ded6e-14ad-49b0-9930-5f462ac7029c","subtype":"command","commandType":"auto","position":13.42578125,"command":"five=correlationRDD.filter(lambda x:x[5]==5)\nfive=five.sortBy(lambda x: x[2],ascending=True)\nrdds[4]=five\nfive.take(5)\nfive=correlationRDD2.filter(lambda x:x[5]==5)\nfive=five.sortBy(lambda x: x[2],ascending=True)\nrdds1[4]=five\nfive.take(5)\nfive=correlationRDD3.filter(lambda x:x[5]==5)\nfive=five.sortBy(lambda x: x[2],ascending=True)\nrdds2[4]=five\nfive.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">15</span><span class=\"ansired\">]: </span>\n[(u&apos;2016-07-22 00:12:00+02&apos;, u&apos;2016-07-22 00:13:00+02&apos;, 0, 4, 6284, 5),\n (u&apos;2016-07-22 02:34:00+02&apos;, u&apos;2016-07-22 02:35:00+02&apos;, 0, 0, 7277, 5),\n (u&apos;2016-07-23 01:24:00+02&apos;, u&apos;2016-07-23 01:25:00+02&apos;, 0, 0, 16744, 5),\n (u&apos;2016-07-24 09:26:00+02&apos;, u&apos;2016-07-24 09:27:00+02&apos;, 0, 1, 29799, 5),\n (u&apos;2016-07-25 08:03:00+02&apos;, u&apos;2016-07-25 08:04:00+02&apos;, 0, 0, 39635, 5)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371106996,"submitTime":1500370213051,"finishTime":1500371233042,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b52424d9-3fda-4999-88c7-5d30b5b27616"},{"version":"CommandV1","origId":1456266427964840,"guid":"3d861aa9-e49f-4c79-b104-1707484f0ddb","subtype":"command","commandType":"auto","position":13.431640625,"command":"six=correlationRDD.filter(lambda x:x[5]==6)\nsix=six.sortBy(lambda x: x[2],ascending=True)\nrdds[5]=six\nsix.take(5)\nsix=correlationRDD2.filter(lambda x:x[5]==6)\nsix=six.sortBy(lambda x: x[2],ascending=True)\nrdds1[5]=six\nsix.take(5)\nsix=correlationRDD3.filter(lambda x:x[5]==6)\nsix=six.sortBy(lambda x: x[2],ascending=True)\nrdds2[5]=six\nsix.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">16</span><span class=\"ansired\">]: </span>\n[(u&apos;2016-07-21 17:31:00+02&apos;, u&apos;2016-07-21 17:32:00+02&apos;, 0, 8, 3482, 6),\n (u&apos;2016-07-22 03:29:00+02&apos;, u&apos;2016-07-22 03:30:00+02&apos;, 0, 0, 7662, 6),\n (u&apos;2016-07-22 05:21:00+02&apos;, u&apos;2016-07-22 05:22:00+02&apos;, 0, 0, 8449, 6),\n (u&apos;2016-07-22 23:57:00+02&apos;, u&apos;2016-07-22 23:58:00+02&apos;, 0, 3, 16133, 6),\n (u&apos;2016-07-23 00:24:00+02&apos;, u&apos;2016-07-23 00:25:00+02&apos;, 0, 0, 16323, 6)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371233050,"submitTime":1500370213057,"finishTime":1500371359172,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"799ecc5d-37b8-4e20-aebb-0217e65238e8"},{"version":"CommandV1","origId":1456266427964841,"guid":"19fbd83b-612d-4c3f-a2c8-4124b60ccd88","subtype":"command","commandType":"auto","position":13.4345703125,"command":"seven=correlationRDD.filter(lambda x:x[5]==7)\nseven=seven.sortBy(lambda x: x[2],ascending=True)\nrdds[6]=two\nseven.take(5)\nseven=correlationRDD2.filter(lambda x:x[5]==7)\nseven=seven.sortBy(lambda x: x[2],ascending=True)\nrdds1[6]=two\nseven.take(5)\nseven=correlationRDD3.filter(lambda x:x[5]==7)\nseven=seven.sortBy(lambda x: x[2],ascending=True)\nrdds2[6]=two\nseven.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">17</span><span class=\"ansired\">]: </span>\n[(u&apos;2016-07-21 11:59:00+02&apos;, u&apos;2016-07-21 12:00:00+02&apos;, 0, 0, 1166, 7),\n (u&apos;2016-07-21 14:20:00+02&apos;, u&apos;2016-07-21 14:21:00+02&apos;, 0, 0, 2151, 7),\n (u&apos;2016-07-21 21:44:00+02&apos;, u&apos;2016-07-21 21:45:00+02&apos;, 0, 0, 5253, 7),\n (u&apos;2016-07-21 23:19:00+02&apos;, u&apos;2016-07-21 23:20:00+02&apos;, 0, 0, 5917, 7),\n (u&apos;2016-07-22 06:38:00+02&apos;, u&apos;2016-07-22 06:39:00+02&apos;, 0, 0, 8989, 7)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371359179,"submitTime":1500370213062,"finishTime":1500371482078,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2a8cdd86-678b-4112-98ed-babc0f7e4ab2"},{"version":"CommandV1","origId":2751569960862883,"guid":"89c355ec-c968-42af-84d9-93dd0d8d520c","subtype":"command","commandType":"auto","position":33.5,"command":"dbutils.fs.rm(\"/user/hive/warehouse/sensordata\", True)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">35</span><span class=\"ansired\">]: </span>True\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500371724795,"submitTime":1500370213176,"finishTime":1500371726508,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0a7a1fd0-de74-41df-94e7-240949ed3991"},{"version":"CommandV1","origId":2998738568508535,"guid":"1aea2385-2d4f-498f-a052-ef92fb36d9e8","subtype":"command","commandType":"auto","position":1.0,"command":"from datetime import datetime, timedelta\n\ndef shiftTime(tup):\n  tup=list(tup)\n  t=str(tup[1])\n  f=str(tup[0])\n  if t.endswith(\"+02\") and f.endswith(\"+02\") :\n    return tup\n  if t.endswith(\"+01\"):\n    to=datetime.strptime(tup[1],'%Y-%m-%d %H:%M:%S+01')\n    to=to+timedelta(hours=1)\n    tup[1]=to.strftime(\"%Y-%m-%d %H:%M:%S+02\")\n  if f.endswith(\"+01\"):\n    fr=datetime.strptime(tup[0],'%Y-%m-%d %H:%M:%S+01')\n    fr=fr+timedelta(hours=1)\n    tup[0]=fr.strftime(\"%Y-%m-%d %H:%M:%S+02\")\n  return tup","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Internal error, sorry. Attach your notebook to a different cluster or restart the current cluster.","error":null,"workflows":[],"startTime":1500370257296,"submitTime":1500370212968,"finishTime":1500370257573,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a13470e8-0ba3-4bde-b22c-8c9b68e004bf"},{"version":"CommandV1","origId":2998738568508541,"guid":"61cffd16-da34-4de9-bd71-9d267df12258","subtype":"command","commandType":"auto","position":7.0,"command":"totalNoRepetition=sqlContext.sql(\"Select first(from) as from,to,first(fw) as fw,first(bw) as bw,first(id) as id,elementid from rawData group by to,elementid \")\ntotalNoRepetition.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">2</span><span class=\"ansired\">]: </span>2597852\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Internal error, sorry. Attach your notebook to a different cluster or restart the current cluster.","error":null,"workflows":[],"startTime":1500370257864,"submitTime":1500370212968,"finishTime":1500370276426,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3fc07076-9a24-4ce8-bd4f-53d64e4d0f31"},{"version":"CommandV1","origId":2998738568508542,"guid":"3b858185-c826-4814-9d04-e6f2de36550c","subtype":"command","commandType":"auto","position":8.0,"command":"%sql DROP TABLE sensorsdata5","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1500370276444,"submitTime":1500370212975,"finishTime":1500370285397,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"487c2f39-d60c-486c-baf1-9e58af57282f"},{"version":"CommandV1","origId":2998738568508543,"guid":"403ab8c0-92ec-4241-bed4-716f2040609a","subtype":"command","commandType":"auto","position":9.0,"command":"totalNoRepetition.write.saveAsTable('sensorsdata5')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;Table &#96;sensorsdata5&#96; already exists.;&apos;","error":null,"workflows":[],"startTime":1500370285572,"submitTime":1500370212980,"finishTime":1500370321811,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a4e89a68-7b87-4c77-8d87-3408b5be7a1c"},{"version":"CommandV1","origId":2998738568508544,"guid":"5d188a5b-d544-43cf-ba26-781af803e949","subtype":"command","commandType":"auto","position":10.0,"command":"until=sqlContext.sql(\"Select  elementid, max(to) from sensorsdata5 where elementid in (1,4,6) group by elementid\")\nuntil.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+\n|elementid|             max(to)|\n+---------+--------------------+\n|        1|2016-12-01 19:28:...|\n|        6|2017-05-02 07:00:...|\n|        4|2016-10-10 15:21:...|\n+---------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1500370321823,"submitTime":1500370212986,"finishTime":1500370338827,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildo.likmeta@mail.polimi.it","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d735ab4e-e075-4df3-8401-1796dcd2e859"}],"dashboards":[],"guid":"b08c318d-9c29-4d3d-a4c2-4049e9b9bac4","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}